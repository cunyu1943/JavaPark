---
isOriginal: true
category:
  - åšå®¢æ­å»º
tag:
    - Vuepress
    - Github
    - åšå®¢
---

# Vuepress + GitHub Actions å®ç°åšå®¢è‡ªåŠ¨éƒ¨ç½²

## ğŸˆ å·å¤–

æœ€è¿‘ï¼Œå…¬ä¼—å·ä¹‹å¤–ï¼Œå»ºç«‹äº†å¾®ä¿¡äº¤æµç¾¤ï¼Œä¸å®šæœŸä¼šåœ¨ç¾¤é‡Œåˆ†äº«å„ç§èµ„æºï¼ˆå½±è§†ã€IT ç¼–ç¨‹ã€è€ƒè¯•æå‡â€¦â€¦ï¼‰&çŸ¥è¯†ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥**æ‰«ç æˆ–è€…åå°æ·»åŠ å°ç¼–å¾®ä¿¡å¤‡æ³¨å…¥ç¾¤**ã€‚è¿›ç¾¤å**ä¼˜å…ˆçœ‹ç¾¤å…¬å‘Š**ï¼Œ**å‘¼å«ç¾¤ä¸­ã€èµ„æºåˆ†äº«å°åŠ©æ‰‹ã€‘**ï¼Œè¿˜èƒ½å…è´¹å¸®æ‰¾èµ„æºå“¦ï½

<center>
<img src="/contact/wxgroup.jpg" width="150"> 
</center>

## å‰è¨€

æ­£å¸¸æˆ‘ä»¬åˆ©ç”¨ Vuepress æ­å»ºä¸€ä¸ªæ–‡æ¡£åšå®¢ä¹‹åï¼Œå¾€å¾€éƒ½æ˜¯é€šè¿‡å¦‚ä¸‹æ­¥éª¤æ¥éƒ¨ç½²ä¸€ç¯‡åšå®¢ï¼š

1.   é¦–å…ˆå†™æ–‡ç« ï¼›
2.   å†™å®Œæ–‡ç« ä¹‹åç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œè¿™é‡Œä¸€èˆ¬ä½¿ç”¨çš„æ˜¯ `npm run build` å‘½ä»¤ï¼Œä½†ä¹Ÿæœ‰ä½¿ç”¨ `yarn build` çš„ï¼›

3.   å°†æˆ‘ä»¬ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ° Github Pagesï¼›
4.   è®¿é—®æˆ‘ä»¬å¯¹åº”çš„ç½‘å€ï¼ŒæŸ¥çœ‹æˆ‘ä»¬çš„æ¨é€æ˜¯å¦æˆåŠŸã€‚

ä¸Šè¿°æ­¥éª¤çœ‹ä¼¼ç®€å•ï¼Œä½†ä¸€æ—¦æ–‡æ¡£è¿‡å¤šæ—¶ï¼Œç”Ÿæˆé™æ€æ–‡ä»¶å°±ååˆ†è€—è´¹æ—¶é—´ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±æƒ³äº†ï¼Œæœ‰ä¸æœ‰ä¸€ç§æ–¹æ³•ï¼Œèƒ½å¤Ÿå¸®æˆ‘ä»¬è‡ªåŠ¨æ„å»ºé™æ€æ–‡ä»¶ç„¶åéƒ¨ç½²åˆ° Github Pages ä¸Šå‘¢ã€‚åˆšå¥½ï¼ŒGithub å®˜æ–¹æä¾›äº†è¿™ä¸ªä¸€ä¸ªå·¥å…·ï¼šGithub Actionsã€‚åˆ©ç”¨å®ƒï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå°†é‡å¿ƒè½¬ç§»åˆ°åˆ›ä½œä¹‹åï¼Œæ¯æ¬¡åˆ›ä½œä¹‹åæ¨é€åˆ°è¿œç¨‹ä¹‹åå®ƒå°±ä¼šè‡ªåŠ¨åç»­å·¥ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•åˆ©ç”¨ Github Action å®ç°è‡ªåŠ¨éƒ¨ç½²æˆ‘ä»¬çš„åšå®¢ã€‚

## ç”Ÿæˆ Token

è¦éƒ¨ç½² Actionsï¼Œé‚£ä¹ˆå®ƒå°±éœ€è¦æœ‰èƒ½å¤Ÿæ“ä½œæˆ‘ä»¬ä»“åº“çš„æƒé™ï¼Œå› æ­¤éœ€è¦æå‰è®¾ç½®ä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆGithub personal accessï¼‰ã€‚è®¾ç½®æ–¹æ³•å¦‚ä¸‹ï¼šè¿›å…¥ Github åï¼Œç‚¹å‡»æˆ‘ä»¬çš„å¤´åƒï¼Œç„¶åä¾æ¬¡è¿›å…¥ `Settings -> Developer settings -> Personal access tokens`ï¼Œå¯¹åº”åœ°å€å°±æ˜¯ [Token ç”Ÿæˆ](https://github.com/settings/tokens)ã€‚ç„¶åç‚¹å‡»å³ä¸Šæ–¹çš„ `Generate new token`ï¼Œæ¥ç€è¾“å…¥ token çš„åå­—ï¼Œè¿™ä¸ªåå­—å¯ä»¥éšæ„ï¼Œä¸è¿‡è¿˜æ˜¯æ¨èæ ¹æ®å®ƒçš„ç”¨é€”æ¥å‘½åã€‚ç„¶åé€‰ `Expiration`ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ª Token çš„æœ‰æ•ˆæœŸï¼Œå¦‚æœæˆ‘ä»¬è¦é•¿æœŸç”¨ï¼Œå»ºè®®é€‰ä¸º `No expiration`ï¼Œæ„æ€å°±æ˜¯æ— æœŸé™ã€‚æœ€åå°±æ˜¯é€‰æƒé™ï¼Œä¸€èˆ¬æ¥è®²è¿™é‡Œé€‰ `repo` å°±å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœä½ ä¸ç¡®å®šï¼Œé‚£å°±å…¨éƒ½é€‰ä¸Šä¹Ÿè¡Œã€‚ç„¶åç‚¹å‡» `Generate Token`ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä»¤ç‰Œï¼Œæ³¨æ„è¿™é‡Œå®ƒåªä¼šå‡ºç°ä¸€æ¬¡ï¼Œä¸€æ—¦åˆ·æ–°è¯¥ç½‘é¡µå°±ä¸è§äº†ï¼Œæ‰€ä»¥æœ€å¥½æŠŠå®ƒå¤åˆ¶åˆ°ä½ çš„å¤‡å¿˜å½•å¤‡ä»½ä¸€ä¸‹ï¼Œè€Œä¸”æˆ‘ä»¬å¾…ä¼šä¹Ÿæ˜¯éœ€è¦ç”¨åˆ°è¿™ä¸ª Token çš„ã€‚

![](assets/20210826-vuepress/5052e39e5de806967f5dcd97619b2984.webp)

![](assets/20210826-vuepress/182c48f80f42f1b2085b0b3684e9b1fc.webp)

## è®¾ç½® Secrets

è¿›å…¥ä½ å­˜æ”¾ä½ åšå®¢æºç çš„é¡¹ç›®ï¼Œç„¶åä»¥æ­¤ç‚¹å‡» `Settings -> Secrets`ï¼Œæ¥ç€ç‚¹å‡»å³ä¸Šè§’çš„ `New repository secret`ï¼Œæ–°å»ºä¸€ä¸ª `Secret`ã€‚è¿™é‡Œçš„åå­—è¦å‘½åä¸º `ACCESS_TOKEN`ï¼Œç„¶å `Value` å°±æ˜¯æˆ‘ä»¬ä¸Šä¸€æ­¥ä¸­æ‰€ç”Ÿæˆçš„ Tokenã€‚

![](assets/20210826-vuepress/73b1aebaa00a49182756a17adac2430c.webp)

![](assets/20210826-vuepress/263ad40d8338b257f2b8852e7b622cad.webp)

## ç¼–å†™ Action

è¿›å…¥é¡¹ç›®çš„çš„ `Actions` é€‰é¡¹ï¼Œç„¶åæ–°å»ºä¸€ä¸ª `workflow`ï¼ˆæˆ‘æ˜¯å› ä¸ºå·²ç»å»ºç«‹è¿‡äº†ï¼Œæ‰€ä»¥æ‰æ˜¯ä¸‹é¢çš„ç•Œé¢ï¼‰ï¼Œé»˜è®¤æ–°å»ºçš„ `workflow` åå­—æ˜¯  `main.yml` è¿™ä¸ªå¯ä»¥è‡ªå·±è‡ªå®šä¹‰ï¼Œæ ¹æ®ä½ è‡ªå·±å–œå¥½æ¥å°±è¡Œäº†ã€‚

![image-20210826100501499](assets/20210826-vuepress/a057ab9c0039b346a0f90a0b2ce30c5a.webp)

ç”Ÿæˆåçš„ `main.yml` ä½äºé¡¹ç›®çš„ `.github/workflows` ç›®å½•ä¸‹ã€‚

![](assets/20210826-vuepress/f2ec4500b986f31f6c1e56b32079c17a.webp)

æ¥ä¸‹æ¥æ˜¯åœ¨ `main.yml` ä¸­å¡«å…¥å¦‚ä¸‹ä¿¡æ¯å³å¯ï¼Œå…·ä½“å®ä¾‹çš„å¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢å®ä¾‹ï¼š

>   https://github.com/cunyu1943/cunyu1943.github.io/

```yml
# name å¯ä»¥è‡ªå®šä¹‰
name: Deploy GitHub Pages

# è§¦å‘æ¡ä»¶ï¼šåœ¨ push åˆ° main/master åˆ†æ”¯åï¼Œæ–°çš„ Github é¡¹ç›® åº”è¯¥éƒ½æ˜¯ mainï¼Œè€Œä¹‹å‰çš„é¡¹ç›®ä¸€èˆ¬éƒ½æ˜¯ master
on:
  push:
    branches:
      - main

# ä»»åŠ¡
jobs:
  build-and-deploy:
    # æœåŠ¡å™¨ç¯å¢ƒï¼šæœ€æ–°ç‰ˆ Ubuntu
    runs-on: ubuntu-latest
    steps:
      # æ‹‰å–ä»£ç 
      - name: Checkout
        uses: actions/checkout@v2
        with:
          persist-credentials: false

      # ç”Ÿæˆé™æ€æ–‡ä»¶
      - name: Build
        run: npm install && npm run docs:build

      # éƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }} # ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰ç”Ÿæˆçš„ secret
          BRANCH: gh-pages # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯ï¼Œå› ä¸º main åˆ†æ”¯å­˜æ”¾çš„ä¸€èˆ¬æ˜¯æºç ï¼Œè€Œ gh-pages åˆ†æ”¯åˆ™ç”¨æ¥å­˜æ”¾ç”Ÿæˆçš„é™æ€æ–‡ä»¶
          FOLDER: docs/.vuepress/dist # vuepress ç”Ÿæˆçš„é™æ€æ–‡ä»¶å­˜æ”¾çš„åœ°æ–¹
```

## éªŒè¯

ç»è¿‡ä¸Šé¢çš„çš„æ­¥éª¤é…ç½®å¥½ä¹‹åï¼Œå°±å¯ä»¥ç‚¹å‡»ä»“åº“çš„ `Actions` æ¥æŸ¥çœ‹éƒ¨ç½²æƒ…å†µäº†ã€‚

![](assets/20210826-vuepress/6d49049a1ba67ac80b5c6480e79da729.webp)

å¦‚æœæ˜¯ç»¿è‰²çš„ï¼Œè¯´æ˜è‡ªåŠ¨éƒ¨ç½²æˆåŠŸäº†ï¼Œå¦‚æœæ˜¯çº¢è‰²ï¼Œé‚£å°±è¯´æ˜éƒ¨ç½²å¤±è´¥ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ç‚¹è¿›å»çœ‹çœ‹éƒ¨ç½²å¤±è´¥çš„æ—¥å¿—ä¿¡æ¯ã€‚

ä»¥æˆ‘éƒ¨ç½²å¤±è´¥çš„ä¸€ä¸ªå®ä¾‹æ¥è®²ï¼Œå¯ä»¥çœ‹åˆ°ä¸»è¦æ˜¯åœ¨éƒ¨ç½²æ­¥éª¤å‡ºäº†é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ç»™å‡ºçš„é”™è¯¯æ—¥å¿—æ¥æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ï¼Œç„¶åæ‰¾æ–¹æ³•è§£å†³å®ƒäº†ã€‚

æˆ‘è¿™é‡Œé”™è¯¯çš„å¤§ä½“æ„æ€å°±æ˜¯è¯´æˆ‘ Vuepress é¡¹ç›®ä¸‹çš„çš„ `dist` ç›®å½•ä¸å­˜åœ¨ï¼Œè€Œè§£å†³æ–¹æ³•åˆ™æ˜¯åœ¨ Vuepress çš„é…ç½®æ–‡ä»¶ä¸­çš„ `dist` è®¾ç½®ä¸º `docs/.vuepress/dist` å³å¯ã€‚

![](assets/20210826-vuepress/8c815342f2679356f1cccc9c28f97f3f.webp)

## æ€»ç»“

ä»¥ä¸Šå°±æ˜¯å…³äº Vuepress + Github Actions å®ç°è‡ªåŠ¨éƒ¨ç½²çš„æ‰€æœ‰å†…å®¹äº†ï¼Œå¦‚æœå¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œé‚£å°±å¸®å¿™ç‚¹èµå…³æ³¨å§ï¼

æœ€åï¼Œè´´å‡ºæˆ‘çš„åšå®¢åœ°å€ï¼Œå¯ä»¥å»çœ‹çœ‹æ•ˆæœï¼

-   é¡¹ç›®æ–‡ä»¶ï¼šhttps://github.com/cunyu1943/cunyu1943.github.io
-   é¢„è§ˆåœ°å€ï¼šhttps://cunyu1943.github.io/