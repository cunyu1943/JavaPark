---
isOriginal: true
order: 1
category:
  - Java åŸºç¡€
tag: Java
---

# Servlet è¯¦ç»†æ•™ç¨‹

> ä½œè€…ï¼š[æ‘é›¨é¥](https://github.com/cunyu1943)
> 
> ä¸è¦å“€æ±‚ï¼Œå­¦ä¼šäº‰å–ï¼Œè‹¥æ˜¯å¦‚æ­¤ï¼Œç»ˆæœ‰æ‰€è·
>

## ğŸˆ å·å¤–

æœ€è¿‘ï¼Œå…¬ä¼—å·ä¹‹å¤–ï¼Œå»ºç«‹äº†å¾®ä¿¡äº¤æµç¾¤ï¼Œä¸å®šæœŸä¼šåœ¨ç¾¤é‡Œåˆ†äº«å„ç§èµ„æºï¼ˆå½±è§†ã€IT ç¼–ç¨‹ã€è€ƒè¯•æå‡â€¦â€¦ï¼‰&çŸ¥è¯†ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥**æ‰«ç æˆ–è€…åå°æ·»åŠ å°ç¼–å¾®ä¿¡å¤‡æ³¨å…¥ç¾¤**ã€‚è¿›ç¾¤å**ä¼˜å…ˆçœ‹ç¾¤å…¬å‘Š**ï¼Œ**å‘¼å«ç¾¤ä¸­ã€èµ„æºåˆ†äº«å°åŠ©æ‰‹ã€‘**ï¼Œè¿˜èƒ½å…è´¹å¸®æ‰¾èµ„æºå“¦ï½

<center>
<img src="/contact/wxgroup.jpg" width="150"> 
</center>

## 1. Servlet ç¨‹åº

### 1.1 ä»€ä¹ˆæ˜¯ Servlet

1. Servlet æ˜¯ JavaEE è§„èŒƒï¼ˆæ¥å£ï¼‰ä¹‹ä¸€
2. Servlet æ˜¯ JavaWeb ä¸‰å¤§ç»„ä»¶ä¹‹ä¸€ï¼Œä¸‰å¤§ç»„ä»¶åˆ†åˆ«æ˜¯ï¼š**Servlet ç¨‹åºã€Filter è¿‡æ»¤å™¨ã€Listener ç›‘å¬å™¨**
3. Servlet æ˜¯è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ Java å°ç¨‹åºï¼Œç”¨äº **æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼ŒåŒæ—¶å“åº”ç»™å®¢æˆ·ç«¯**

### 1.2 å¦‚ä½•æ‰‹åŠ¨åˆ›å»ºå®ç° Servlet æ¥å£

1. é¦–å…ˆç¼–å†™ä¸€ä¸ªç±»ï¼Œç”¨äºå®ç° Servlet æ¥å£

2. é‡å†™ service æ–¹æ³•ï¼Œç”¨äºå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒåŒæ—¶å“åº”æ•°æ®

```java
package com.cunyu.servlet;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * Created with IntelliJ IDEA.
 * Version : 1.0
 * Author  : æ‘é›¨é¥
 * Email   : cunyu1024@foxmail.com
 * Website : https://cunyu1943.github.io
 * å…¬ä¼—å·   ï¼šæ‘é›¨é¥
 * Date    : 2020/6/4 ä¸‹åˆ3:08
 * Project : JavaLearning
 * Package : com.cunyu.servlet
 * Class   : HelloServlet
 * Desc    : Hello å¯åŠ¨é¡µ
 */
public class HelloServlet extends HttpServlet {
    /**
     * service ä¸“é—¨ç”¨äºå¤„ç†è¯·æ±‚å’Œå“åº”çš„æ–¹æ³•
     *
     * @param req  è¯·æ±‚
     * @param resp å“åº”
     * @throws ServletException
     * @throws IOException
     */
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        System.out.println("Hello Servletï¼ŒMy first Servlet Appï¼");
    }
}

```

3. å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œå» `web.xml` ä¸­é…ç½® Servlet æ¥å£çš„è®¿é—®åœ°å€

```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">
    
    <!--  ç»™ Tomcat é…ç½® Servlet ç¨‹åº -->
    <servlet>
        <!--    Servlet ç¨‹åºåˆ«åï¼ˆå»ºè®®ä¸ºç±»åï¼‰    -->
        <servlet-name>HelloServlet</servlet-name>
        <!--    Servlet ç¨‹åºçš„å…¨ç±»å    -->
        <servlet-class>com.cunyu.servlet.HelloServlet</servlet-class>
    </servlet>

    <!--  ç»™ Servlet ç¨‹åºé…ç½®è®¿é—®åœ°å€  -->
    <servlet-mapping>
        <!--    å‘Šè¯‰æœåŠ¡å™¨ï¼Œå½“å‰é…ç½®çš„åœ°å€ç»™å“ªä¸ª Servlet ç¨‹åºä½¿ç”¨    -->
        <servlet-name>HelloServlet</servlet-name>
        <!--    é…ç½®è®¿é—®åœ°å€ï¼Œè¡¨ç¤ºåœ°å€ä¸º http://ip:port/å·¥ç¨‹è·¯å¾„/hello    -->
        <url-pattern>/hello</url-pattern>
    </servlet-mapping>
</web-app>
```

4. å¯åŠ¨ Tomcat åœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:8080/servletTest/hello`ï¼Œç„¶ååå°å°±ä¼šæ‰§è¡Œ `service()` æ–¹æ³•

![](assets/20200521-servlet/format,png-20240216200359741-8085039.png)

### 1.3 Servlet çš„ç”Ÿå‘½å‘¨æœŸ

1. æ‰§è¡Œ Servlet æ„é€ å™¨æ–¹æ³•ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶åˆ›å»º Servlet ç¨‹åºä¼šè°ƒç”¨
2. æ‰§è¡Œ `init` åˆå§‹åŒ–æ–¹æ³•ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶åˆ›å»º Servlet ç¨‹åºä¼šè°ƒç”¨
3. æ‰§è¡Œ `service()` æ–¹æ³•ï¼Œæ¯æ¬¡è®¿é—®å‡è°ƒç”¨
4. æ‰§è¡Œ `destory()` é”€æ¯æ–¹æ³•ï¼ŒWeb å·¥ç¨‹åœæ­¢æ—¶è°ƒç”¨

### 1.4 å¦‚ä½•é€šè¿‡ IDEA å¿«é€Ÿåˆ›å»º Servlet ç¨‹åº

é€‰ä¸­ `src` ç›®å½•æˆ–è€…è¦ç”Ÿæˆ Servlet çš„åŒ…ï¼Œç„¶åå•å‡»é¼ æ ‡å³é”®ï¼Œ`New -> Create New Servlet`ï¼Œæ¥ç€å¡«å†™ Servlet ç¨‹åºåï¼Œæ‰€å±åŒ…ä»¥åŠ Servlet å…¨ç±»åï¼ŒåŒæ—¶ **å–æ¶ˆå‹¾é€‰** Java EE 6 å³å¯ï¼Œå‹¾é€‰åˆ™ä¼šç”Ÿæˆæ³¨è§£å¼é…ç½®ï¼Œåç»­å­¦ä¹ è¿‡ç¨‹ä¸­æ‰ä¼šæ¥è§¦åˆ°ã€‚

![](assets/20200521-servlet/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2dpdGh1Yl8zOTY1NTAyOQ==,size_16,color_FFFFFF,t_70-20240216200359719.png)

![](assets/20200521-servlet/format,png-20240216200359710.png)

ç‚¹å‡»ç”Ÿæˆä¹‹åï¼Œå°±ä¼šç”Ÿæˆ Servlet ç¨‹åºä»¥åŠåœ¨ `web.xml` ä¸­çš„é…ç½®ã€‚

![](assets/20200521-servlet/format,png-20240216200359722.png) 

### 1.5 æ•´ä¸ª Servlet ç±»çš„ç»§æ‰¿ä½“ç³»

![](assets/20200521-servlet/format,png-20240216200359697.png)

## 2. ServletConfig ç±»

ä»ç±»åä¸Šå°±å¯ä»¥çœ‹å‡ºï¼ŒServletConfig æ˜¯ä¸€ä¸ªé…ç½®ä¿¡æ¯ç±»ã€‚Servlet ç¨‹åºå’Œ ServletConfig å¯¹è±¡å‡ç”± Tomcat åˆ›å»ºï¼Œè€Œæˆ‘ä»¬åªè¦ä½¿ç”¨å°±å¯ä»¥äº†ã€‚æ­¤å¤–ï¼ŒServlet ç¨‹åºé»˜è®¤æ˜¯åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶å°±åˆ›å»ºäº†ï¼Œè€Œ **ServletConfig å¯¹è±¡åˆ™æ˜¯æ¯ä¸ª Servlet ç¨‹åºåˆ›å»ºæ—¶æ‰€å¯¹åº”åˆ›å»º**ã€‚

### 2.1 ServletConfig ç±»çš„ä¸‰å¤§ä½œç”¨

1. è·å– Servlet ç¨‹åºçš„åˆ«åï¼Œå³ `web.xml` ä¸­é…ç½®çš„ `servlet-name`
2. è·å–åˆå§‹åŒ–å‚æ•°ï¼Œå³ `web.xml` ä¸­é…ç½®çš„ `init-param`
3. è·å– ServletContext å¯¹è±¡

åŠ å…¥æˆ‘ä»¬çš„ `web.xml` é…ç½®å¦‚ä¸‹ï¼Œç„¶åå°±å¯ä»¥åˆ©ç”¨ åˆå§‹åŒ–æ–¹æ³•æ¥è·å–ä¸Šè¿°ä¸‰ä¸ªå€¼ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">

    <!--  ç»™ Tomcat é…ç½® Servlet ç¨‹åº -->
    <servlet>
        <!--    Servlet ç¨‹åºåˆ«åï¼ˆå»ºè®®ä¸ºç±»åï¼‰    -->
        <servlet-name>HelloServlet</servlet-name>
        <!--    Servlet ç¨‹åºçš„å…¨ç±»å    -->
        <servlet-class>com.cunyu.servlet.HelloServlet</servlet-class>

        <init-param>
            <param-name>userName</param-name>
            <param-value>root</param-value>
        </init-param>
    </servlet>


    <!--  ç»™ Servlet ç¨‹åºé…ç½®è®¿é—®åœ°å€  -->
    <servlet-mapping>
        <!--    å‘Šè¯‰æœåŠ¡å™¨ï¼Œå½“å‰é…ç½®çš„åœ°å€ç»™å“ªä¸ª Servlet ç¨‹åºä½¿ç”¨    -->
        <servlet-name>HelloServlet</servlet-name>
        <!--    é…ç½®è®¿é—®åœ°å€ï¼Œè¡¨ç¤ºåœ°å€ä¸º http://ip:port/å·¥ç¨‹è·¯å¾„/hello    -->
        <url-pattern>/hello</url-pattern>
    </servlet-mapping>


</web-app>

```

```java
package com.cunyu.servlet;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * Created with IntelliJ IDEA.
 * Version : 1.0
 * Author  : æ‘é›¨é¥
 * Email   : cunyu1024@foxmail.com
 * Website : https://cunyu1943.github.io
 * å…¬ä¼—å·   ï¼šæ‘é›¨é¥
 * Date    : 2020/6/4 ä¸‹åˆ3:08
 * Project : JavaLearning
 * Package : com.cunyu.servlet
 * Class   : HelloServlet
 * Desc    : Hello å¯åŠ¨é¡µ
 */
public class HelloServlet extends HttpServlet {
    /**
     * service ä¸“é—¨ç”¨äºå¤„ç†è¯·æ±‚å’Œå“åº”çš„æ–¹æ³•
     *
     * @param req  è¯·æ±‚
     * @param resp å“åº”
     * @throws ServletException
     * @throws IOException
     */
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        System.out.println("Hello Servletï¼ŒMy first Servlet Appï¼");
    }

    @Override
    public void init(ServletConfig config) throws ServletException {
        super.init(config);
        System.out.println("åˆå§‹åŒ–æ–¹æ³•");
//        è·å– Servlet ç¨‹åºåˆ«å servlet-name
        System.out.println("åˆ«åï¼š" + config.getServletName());
//        è·å–åˆå§‹åŒ–å‚æ•° init-param
        System.out.println("åˆå§‹åŒ–å‚æ•°ï¼š" + config.getInitParameter("userName"));
//        è·å– ServletContext å¯¹è±¡
        System.out.println(config.getServletContext());
    }
}
```

## 3. ServletContext ç±»

### 3.1 ServletContext æ˜¯å•¥

1. ServletContext æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè¡¨ç¤º Servlet ä¸Šä¸‹æ–‡å¯¹è±¡

2. ServletContext å¯¹è±¡æ˜¯ä¸€ä¸ª **åŸŸå¯¹è±¡**

3. æ¯ä¸ª Web å·¥ç¨‹åªå¯¹åº” **ä¸€ä¸ª** ServletContext å¯¹è±¡å®ä¾‹ 
4. æ¯ä¸ª ServletContext åœ¨ Web å·¥ç¨‹éƒ¨ç½²å¯åŠ¨æ—¶åˆ›å»ºï¼Œç„¶ååœ¨ Web å·¥ç¨‹åœæ­¢æ—¶é”€æ¯

### 3.2 ServletContext çš„ä½œç”¨

1. è·å– `web.xml` é…ç½®ä¸­çš„ä¸Šä¸‹æ–‡å‚æ•° `context-param`
2. è·å–å½“å‰ Web å·¥ç¨‹è·¯å¾„ï¼Œå¦‚ `/ServletTest`
3. è·å–å·¥ç¨‹éƒ¨ç½²ååœ¨æœåŠ¡å™¨çš„ä¸­çš„ç»å¯¹è·¯å¾„ï¼ŒåŒ…æ‹¬å„ç§é™æ€èµ„æºç­‰è·¯å¾„
4. ServletContext æ˜¯é€šè¿‡ **é”®å€¼å¯¹ï¼ˆMapï¼‰** ä¸€æ ·å­˜å–æ•°æ®

ä»¥ä¸‹å¯¹ä¸Šè¿° 4 ä¸ªä½œç”¨è¿›è¡Œå®ä¾‹ä»‹ç»ï¼Œé¦–å…ˆåœ¨ `web.xml` åŠ å…¥å¦‚ä¸‹é…ç½®ï¼Œç„¶åé€šè¿‡ç¨‹åºæ¥è·å–å„ç§å‚æ•°ï¼š

```xml
<!--context-param æ˜¯ä¸Šä¸‹æ–‡å‚æ•°ï¼Œå±äº Web å·¥ç¨‹-->
    <context-param>
        <param-name>wechat</param-name>
        <param-value>cunyu1943</param-value>
    </context-param>

    <servlet>
        <servlet-name>ServletContextServlet</servlet-name>
        <servlet-class>com.cunyu.servlet.ServletContextServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>ServletContextServlet</servlet-name>
        <url-pattern>/servletContext</url-pattern>
    </servlet-mapping>
```

```java
package com.cunyu.servlet;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * Created with IntelliJ IDEA.
 * Version : 1.0
 * Author  : æ‘é›¨é¥
 * Email   : cunyu1024@foxmail.com
 * Website : https://cunyu1943.github.io
 * å…¬ä¼—å·   ï¼šæ‘é›¨é¥
 * Date    : 2020/6/5 ä¸Šåˆ8:36
 * Project : JavaLearning
 * Package : ${PACKAGE_NAME}
 * Class   : ${CLASS_NAME}
 * Desc    : ServletContext åŠŸèƒ½
 */
public class ServletContextServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
//        1. è·å–ä¸Šä¸‹æ–‡å‚æ•° context-param
        ServletContext servletContext = getServletContext();
        String url = servletContext.getInitParameter("url");
        System.out.println("URL çš„å€¼æ˜¯ï¼š" + url);

//        2. è·å–å·¥ç¨‹è·¯å¾„
        System.out.println("å·¥ç¨‹è·¯å¾„ï¼š" + servletContext.getContextPath());

//        3. è·å–å·¥ç¨‹éƒ¨ç½²åæœåŠ¡å™¨ä¸Šçš„ç»å¯¹è·¯å¾„
//        å…¶ä¸­ / è¢«è§£æä¸ºï¼šhttp://ip:port/å·¥ç¨‹å/ ï¼Œæ˜ å°„åˆ° IDEA ä»£ç çš„ web ç›®å½•
        System.out.println("å·¥ç¨‹éƒ¨ç½²ç»å¯¹è·¯å¾„ï¼š" + servletContext.getRealPath("/"));

//        4. é€šè¿‡ é”®å€¼å¯¹ å­˜å–æ•°æ®ï¼Œæ³¨æ„ï¼šServletContext å±äº Web å·¥ç¨‹ï¼Œæ‰€ä»¥åªè¦å·¥ç¨‹å¯åŠ¨åˆ›å»ºä¹‹åï¼ŒServlet ç¨‹åºéƒ½èƒ½è®¿é—®ï¼Œç›´åˆ°å…³åœ Web å·¥ç¨‹
        System.out.println("ServletContext å¯¹è±¡:" + servletContext);
//        å­˜æ•°æ®
        servletContext.setAttribute("password", "1234567");
//        å–æ•°æ®
        System.out.println("password çš„å€¼æ˜¯ï¼š" + servletContext.getAttribute("password"));
    }
}
```

## 4. HTTP åè®®

### 4.1 ä»€ä¹ˆæ˜¯ HTTP åè®®

**åè®®** å³æŒ‡ä¸¤æ–¹æˆ–å¤šæ–¹é€šè¿‡ä¸€å®šåå•†çº¦å®šåï¼Œå¤§å®¶éƒ½è¦éµå®ˆçš„è§„åˆ™ï¼Œå«åšåè®®ã€‚

è€Œ **HTTP åè®®** ï¼Œå³æŒ‡ **å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´äº’ç›¸é€šä¿¡æ—¶ï¼Œå‘é€æ•°æ®æ—¶æ‰€éœ€è¦éµå®ˆçš„è§„åˆ™**ï¼ŒHTTP åè®®ä¸­çš„æ•°æ®åˆå«åš **æŠ¥æ–‡**ã€‚

### 4.2 è¯·æ±‚çš„ HTTP åè®®æ ¼å¼

å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®çš„è¡Œä¸ºå«åš **è¯·æ±‚**ï¼Œè€ŒæœåŠ¡å™¨å‘å®¢æˆ·ç«¯å›ä¼ æ•°æ®çš„è¡Œä¸ºå«åš **å“åº”**ã€‚

#### GET è¯·æ±‚

ç”± **è¯·æ±‚è¡Œ + è¯·æ±‚å¤´** ç»„æˆï¼Œå…¶ä¸­ **è¯·æ±‚è¡Œ** åŒ…æ‹¬ **è¯·æ±‚çš„æ–¹å¼ã€è¯·æ±‚çš„èµ„æºè·¯å¾„ä»¥åŠè¯·æ±‚çš„åè®®ç‰ˆæœ¬å·**ï¼Œè€Œ **è¯·æ±‚å¤´** åˆ™æ˜¯ç”± `key-value` å¯¹ç»„æˆï¼Œä¸åŒé”®å€¼å¯¹å¯¹åº”ä¸åŒå«ä¹‰ï¼Œå…·ä½“è¯·çœ‹å¦‚ä¸‹å›¾å®ä¾‹ã€‚GET è¯·æ±‚æœ€å¸¸ç”¨çš„åœ°æ–¹ï¼š

1.  `form` æ ‡ç­¾ `method=get`
2.  `a` æ ‡ç­¾
3.  `link` æ ‡ç­¾å¼•å…¥ `css`
4.  `Script` æ ‡ç­¾å¼•å…¥ `js` 
5.  `img` æ ‡ç­¾å¼•å…¥å›¾ç‰‡
6.  `iframe` å¼•å…¥ HTML é¡µé¢
7.  æµè§ˆå™¨ä¸­åœ°å€æ è¾“å…¥åœ°å€åå›è½¦

![](assets/20200521-servlet/format,png-20240216200359733.png)

#### POST è¯·æ±‚

POST è¯·æ±‚å’Œ GET çš„æœ€å¤§åŒºåˆ«åœ¨äº **è¯·æ±‚å¤´ï¼ˆå³å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼‰**ï¼ŒPOST ç”± **è¯·æ±‚è¡Œ + è¯·æ±‚å¤´ + è¯·æ±‚ä½“** ç»„æˆï¼Œå…¶ä¸­è¯·æ±‚è¡Œä¸è¯·æ±‚å¤´çš„å«ä¹‰å’Œ GET è¯·æ±‚çš„å«ä¹‰ç›¸åŒï¼Œè€Œ **è¯·æ±‚å¤´åˆ™æ˜¯ POST æ–¹å¼ç‹¬æœ‰**ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼Œæœ€å¸¸ç”¨çš„åœ°æ–¹ï¼š

1. `form` æ ‡ç­¾ `method=post`

![](assets/20200521-servlet/format,png-20240216200359759.png)

### 4.3 å“åº”çš„ HTTP åè®®æ ¼å¼

å“åº”ä¸»è¦ç”± **å“åº”è¡Œ + å“åº”å¤´ + å“åº”ä½“** å…±åŒç»„æˆï¼Œå“åº”è¡Œä¸­åˆåŒ…æ‹¬ **å“åº”çš„åè®®å’Œç‰ˆæœ¬å·ã€å“åº”çŠ¶æ€ç ä»¥åŠå“åº”çŠ¶æ€æè¿°ç¬¦**ï¼Œè€Œ **å“åº”å¤´åˆ™æ˜¯åŒæ ·ç”±ä¸åŒçš„é”®å€¼å¯¹ç»„æˆ**ï¼Œ**å“åº”ä½“ä¸­åˆ™æ˜¯å›ä¼ ç»™å®¢æˆ·ç«¯çš„æ•°æ®**ï¼Œå…·ä½“çœ‹ä¸‹è¾¹çš„ç¤ºä¾‹ï¼š

![](assets/20200521-servlet/format,png-20240216200359741.png)

### 4.4 å¸¸ç”¨å“åº”ç 

| å“åº”ç  | è¯´æ˜                                                   |
| ------ | ------------------------------------------------------ |
| 200    | è¯·æ±‚æˆåŠŸ                                               |
| 302    | è¯·æ±‚é‡å®šå‘                                             |
| 404    | è¯·æ±‚æœåŠ¡å™¨å·²ç»æ”¶åˆ°ï¼Œä½†éœ€è¦çš„æ•°æ®ä¸å­˜åœ¨ï¼ˆè¯·æ±‚åœ°å€é”™è¯¯ï¼‰ |
| 500    | æœåŠ¡å™¨å·²ç»æ”¶åˆ°è¯·æ±‚ï¼Œä½†æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼ˆä»£ç é”™è¯¯ï¼‰       |

### 4.5 MIME ç±»å‹è¯´æ˜

MIME å…¨ç§° **å¤šåŠŸèƒ½ Internet é‚®ä»¶æ‰©å……æœåŠ¡** `ï¼ˆMultipurpose Internet Mail Extensionï¼‰` ï¼Œæ˜¯ HTTP åè®®ä¸­çš„æ•°æ®ç±»å‹ï¼Œæ ¼å¼æ˜¯ **å¤§ç±»å‹/å°ç±»å‹**ï¼Œå¹¶ä¸æŸç§æ–‡ä»¶æ‰©å±•åç›¸å¯¹åº”ï¼Œæœ€å¸¸è§çš„ MIME ç±»å‹å¦‚ä¸‹ï¼š

| æ–‡ä»¶ç±»å‹           | æ–‡ä»¶æ‰©å±•å    | MIME ç±»å‹                  |
| ------------------ | ------------- | -------------------------- |
| è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬ | `.htmlã€.htm` | `text/html`                |
| æ™®é€šæ–‡æœ¬           | `.txt`        | `text/plain`               |
| RTF æ–‡æœ¬           | `.rtf`        | `application/rtg`          |
| GIF å›¾å½¢           | `.gif`        | `image/gif`                |
| JPEG å›¾å½¢          | `.jpegã€.jpg` | `image/jpeg`               |
| au å£°éŸ³æ–‡ä»¶        | `.au`         | `audio/basic`              |
| MIDI éŸ³ä¹æ–‡ä»¶      | `.midã€.midi` | `audio/midiã€audio/x-midi` |
| RealAudio éŸ³ä¹æ–‡ä»¶ | `.raã€.ram`   | `audio/x-pn-realaudio`     |
| MPEG æ–‡ä»¶          | `.mpgã€.mpeg` | `video/mpeg`               |
| AVI æ–‡ä»¶           | `.avi`        | `video/x-msvideo`          |
| GZIP æ–‡ä»¶          | `.gz`         | `application/x-gzip`       |
| TAR æ–‡ä»¶           | `.tar`        | `application/x-tar`        |

## 5 HttpServletRequest ç±»

### 5.1 HttpServletRequest ç±»çš„ä½œç”¨

å½“æ¯æ¬¡ Tomcat æœåŠ¡å™¨æ¥æ”¶åˆ°æ¥è‡ªæµè§ˆå™¨çš„è¯·æ±‚æ—¶ï¼ŒTomcat æœåŠ¡å™¨éƒ½ä¼šæŠŠè¯·æ±‚è¿‡æ¥çš„ HTTP åè®®ä¿¡æ¯è§£æå¥½å°è£…åˆ° `Request` å¯¹è±¡ä¸­ï¼Œç„¶åä¼ é€’åˆ° `service` æ–¹æ³•ï¼ˆ`doGet` å’Œ `doPost`ï¼‰ä¾›æµè§ˆå™¨ä½¿ç”¨ã€‚è€Œæˆ‘ä»¬åˆ™å¯ä»¥é€šè¿‡ `HttpServletRequest` å¯¹è±¡è·å–åˆ° **æ‰€æœ‰è¯·æ±‚çš„ä¿¡æ¯**ã€‚

### 5.2 HttpServletRequest ç±»å¸¸ç”¨æ–¹æ³•

| æ–¹æ³•                       | è¯´æ˜                                 |
| -------------------------- | ------------------------------------ |
| `getRequestURI()`          | è·å–è¯·æ±‚çš„èµ„æºè·¯å¾„                   |
| `getRequestURL()`          | è·å–è¯·æ±‚çš„ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆç»å¯¹è·¯å¾„ï¼‰ |
| `getRemoteHost()`          | è·å–å®¢æˆ·ç«¯çš„ ip                      |
| `getHeader()`              | è·å–è¯·æ±‚å¤´                           |
| `getParameter()`           | è·å–è¯·æ±‚çš„å‚æ•°                       |
| `getParameterValues()`     | è·å–è¯·æ±‚çš„å‚æ•°ï¼ˆå¤šä¸ªå€¼ï¼‰             |
| `getMethod()`              | è·å–è¯·æ±‚çš„æ–¹å¼ GET æˆ– POST           |
| `setAttribute(key, value)` | è®¾ç½®åŸŸæ•°æ®                           |
| `getAttribute(key)`        | è·å–åŸŸæ•°æ®                           |
| `getRequestDispatcher()`   | è·å–è¯·æ±‚è½¬å‘å¯¹è±¡                     |

### 5.3 POST å’Œ GET è¯·æ±‚æ–¹å¼çš„ä¸­æ–‡ä¹±ç é—®é¢˜

å½“ä»¥ POST æˆ– GET æ–¹å¼è¯·æ±‚æ—¶ï¼Œé‡åˆ°ä¸­æ–‡å¯èƒ½ä¼šå‡ºç°ä¹±ç ï¼Œå¯¹åº”è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š

- **POST æ–¹å¼**ï¼šç›´æ¥å°†è¯·æ±‚ä½“çš„å­—ç¬¦é›†è®¾ç½®ä¸º UTF-8 å³å¯
- **GET æ–¹å¼**ï¼šå…ˆä»¥ iso8859-1 è¿›è¡Œç¼–ç ï¼Œç„¶åå†ä»¥ UTF-8 è¿›è¡Œè§£ç 

```java
package com.cunyu.servlet;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * Created with IntelliJ IDEA.
 * Version : 1.0
 * Author  : æ‘é›¨é¥
 * Email   : cunyu1024@foxmail.com
 * Website : https://cunyu1943.github.io
 * å…¬ä¼—å·   ï¼šæ‘é›¨é¥
 * Date    : 2020/6/6 ä¸‹åˆ9:18
 * Project : JavaLearning
 * Package : ${PACKAGE_NAME}
 * Class   : ${CLASS_NAME}
 * Desc    : è·å–è¯·æ±‚å‚æ•°ä¸­æ–‡ä¹±ç é—®é¢˜
 */
public class ParameterServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
//        POST ä¸­æ–‡ä¹±ç ï¼Œè®¾ç½®è¯·æ±‚ä½“å­—ç¬¦é›† UTF-8ï¼Œè¦åœ¨è·å–å‚æ•°å‰è°ƒç”¨
        req.setCharacterEncoding("UTF-8");
        System.out.println(req.getParameter("hobby"));

    }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter("username");
        String password = request.getParameter("password");

//        GET ä¸­æ–‡ä¹±ç 
//        å…ˆä»¥ iso8859-1 è¿›è¡Œç¼–ç 
//        ç„¶åä»¥ UTF-8 è¿›è¡Œè§£ç 
        username = new String(username.getBytes("ISO-8859-1"), "UTF-8");
        System.out.println("ç”¨æˆ·åï¼š" + username);
        System.out.println("å¯†ç ï¼š" + password);
    }
}
```

### 5.4 è¯·æ±‚çš„è½¬å‘

#### å®šä¹‰

è¯·æ±‚çš„è½¬å‘å³ **å½“æœåŠ¡å™¨æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ—¶ï¼Œä»ä¸€ä¸ªèµ„æºè·³è½¬åˆ°å¦ä¸€ä¸ªèµ„æºçš„æ“ä½œ**ã€‚

![](assets/20200521-servlet/format,png-20240216200359765.png)

#### ç‰¹ç‚¹

- åœ°å€æ æœªå˜
- å±äºä¸€æ¬¡è¯·æ±‚
- å…±äº« Request åŸŸä¸­çš„å‚æ•°
- å¯ä»¥è½¬å‘åˆ° WEB-INF ç›®å½•ä¸‹
- ä¸èƒ½è®¿é—®å·¥ç¨‹ä¹‹å¤–çš„èµ„æº

### 5.5 base æ ‡ç­¾çš„ä½œç”¨

ç”¨äºè®¾ç½®é¡µé¢ç›¸å¯¹è·¯å¾„å·¥ä½œæ—¶å‚ç…§çš„è·¯å¾„ï¼Œå‚ç…§æŸä¸€åœ°å€è¿›è¡Œè·³è½¬ã€‚

```html
<base href="https:cunyu1943.github.io">
```

### 5.6 Web ä¸­ / çš„ä¸åŒæ„ä¹‰

åœ¨ Web ä¸­ /  æ˜¯ä¸€ç§ç»å¯¹è·¯å¾„ï¼Œè‹¥ **è¢«æµè§ˆå™¨è§£æ**ï¼Œåˆ™å¾—åˆ°çš„åœ°å€æ˜¯ ï¼š`http:/ip:port/`ï¼›è‹¥ **è¢«æœåŠ¡å™¨è§£æ**ï¼Œåˆ™å¾—åˆ°çš„åœ°å€æ˜¯ï¼š`http://ip:port/å·¥ç¨‹è·¯å¾„`ã€‚

**æ³¨æ„ï¼š `response.sendRedirect("/");`**ï¼Œè¡¨ç¤ºå°† / å‘é€ç»™æµè§ˆå™¨è§£æï¼Œå¾—åˆ° `http://ip:port/`

## 6. HttpServletResponse ç±»

### 6.1 HttpServletResponse çš„ä½œç”¨

åŒ `HttpServletRequest` ç±»ä¸€æ ·ï¼Œå½“æ¯æ¬¡æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚è¿›æ¥æ—¶ï¼ŒæœåŠ¡å™¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ª `Response` å¯¹è±¡ï¼Œç„¶åä¼ é€’ç»™ Servlet ç¨‹åºä½¿ç”¨ã€‚**`HttpServletRequest` è¡¨ç¤ºè¯·æ±‚è¿‡æ¥çš„ä¿¡æ¯ï¼Œ`HttpServletResponse` åˆ™è¡¨ç¤ºæ‰€æœ‰å“åº”çš„ä¿¡æ¯ã€‚** å½“è®¾ç½®æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ä¿¡æ¯æ—¶ï¼Œé€šè¿‡ `HttpServletResponse` å¯¹è±¡è¿›è¡Œã€‚

### 6.2 ä¸¤ä¸ªè¾“å‡ºæµ

è¾“å‡ºæµåˆ†ä¸º **å­—èŠ‚æµå’Œå­—ç¬¦æµ**ï¼Œä¸¤è€…å¯¹åº”çš„æ–¹æ³•å’ŒåŠŸèƒ½å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ—¶ï¼Œ**åªèƒ½åŒæ—¶ä½¿ç”¨å…¶ä¸­ä¹‹ä¸€** ã€‚

| è¾“å‡ºæµç±»å‹ | æ–¹æ³•                | åŠŸèƒ½                         |
| ---------- | ------------------- | ---------------------------- |
| å­—èŠ‚æµ     | `getOutputStream()` | å¸¸ç”¨äºä¸‹è½½ï¼ˆä¼ é€’äºŒè¿›åˆ¶æ•°æ®ï¼‰ |
| å­—ç¬¦æµ     | `getWriter()`       | å¸¸ç”¨äºå›ä¼ å­—ç¬¦ä¸²             |

### 6.3 å¦‚ä½•å‘å®¢æˆ·ç«¯å›ä¼ æ•°æ®åŠä¸­æ–‡ä¹±ç 

é€šå¸¸æˆ‘ä»¬éœ€è¦å‘å®¢æˆ·ç«¯å›ä¼ æ•°æ®ï¼Œå¦‚æœæ˜¯å›ä¼ å­—ç¬¦ä¸²ç­‰æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **å­—ç¬¦æµæ–¹æ³• `getWriter()`**ã€‚

```java
public class ResponseIOServlet extends HttpServlet{
    @Override
    protected void doGet(HttpServletRequest req, HttpSevletResponse resp) throws ServletException, IOException{
        // å‘å®¢æˆ·ç«¯å›ä¼  å­—ç¬¦ä¸² æ•°æ®
        PrintWriter writer = resp.getWriter();
        writer.write("response's content!!!");
    }
}
```

ä½†å½“æˆ‘ä»¬å›ä¼ ä¸­æ–‡æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä¹±ç é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œé€šå¸¸æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š

1. è®¾ç½®æœåŠ¡å™¨å­—ç¬¦é›†ä¸º UTF-8ï¼ŒåŒæ—¶é€šè¿‡å“åº”å¤´è®¾ç½®æµè§ˆå™¨ä¹Ÿä½¿ç”¨ UTF-8 å­—ç¬¦é›†

```java
// è®¾ç½®æœåŠ¡å™¨å­—ç¬¦é›†
resp.setCharacterEncoding("UTF-8");
// é€šè¿‡å“åº”å¤´è®¾ç½®æµè§ˆå™¨å­—ç¬¦é›†
resp.setHeader("Content-Type", "text/html;charset=UTF-8");
```

2. åŒæ—¶è®¾ç½®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‡ä½¿ç”¨ UTF-8 å­—ç¬¦é›†ï¼Œä½†æ˜¯å¿…é¡»åœ¨è·å–æµå¯¹è±¡ä¹‹å‰è°ƒç”¨ï¼Œ**æ›´ä¸ºæ¨è**

```java
// åŒæ—¶è®¾ç½®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å­—ç¬¦é›†
resp.setContentType("text/html;charset=UTF-8")
```

### 6.4 è¯·æ±‚é‡å®šå‘

#### å®šä¹‰

è¯·æ±‚é‡å®šå‘æ˜¯ **æŒ‡å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨å›ä¼ ç»™å®¢æˆ·ç«¯ä¸€äº›åœ°å€ï¼Œç„¶å®¢æˆ·ç«¯å»è®¿é—®ã€‚ä¹‹æ‰€ä»¥å«åšé‡å®šå‘ï¼Œæ˜¯å› ä¸ºä¹‹å‰çš„åœ°å€å¯èƒ½å·²ç»è¢«åºŸå¼ƒ**ã€‚

![](assets/20200521-servlet/format,png-20240216200359782.png)

#### ç‰¹ç‚¹

1. åœ°å€æ å˜åŒ–
2. ä¸¤æ¬¡è¯·æ±‚
3. ä¸å…±äº« Request åŸŸä¸­æ•°æ®
4. ä¸èƒ½é‡å®šå‘åˆ° WEB-INF ç›®å½•ä¸‹èµ„æº
5. èƒ½è®¿é—®å·¥ç¨‹å¤–çš„èµ„æº

#### å®ç°é‡å®šå‘çš„ä¸¤ç§æ–¹å¼

1. è®¾ç½®å“åº”çŠ¶æ€ç  302 è¡¨ç¤ºé‡å®šå‘ï¼Œç„¶åé€šè¿‡è®¾ç½®å“åº”å¤´è¯´æ˜æ–°åœ°å€

```java
// è®¾ç½®å“åº”çŠ¶æ€ç 
resp.setStatus(302);
// é€šè¿‡è®¾ç½®å“åº”å¤´ï¼Œè¯´æ˜æ–°åœ°å€
resp.setHeader("Location", "https://cunyu1943.github.io");
```

2. ç›´æ¥ä½¿ç”¨ `sendRedirect()` æ–¹æ³•è®¾ç½®æ–°åœ°å€å³å¯ï¼Œ**æ›´ä¸ºæ¨è**

```java
resp.sendRedirect("https://cunyu1943.github.io");
```