---
isOriginal: true
category: Nginx æ•™ç¨‹
tag:
    - Nginx
date: 2022-10-16
---

# ç®€ä»‹ä¸ç¯å¢ƒæ­å»º

>
> ä¸è¦å“€æ±‚ï¼Œå­¦ä¼šäº‰å–ã€‚è‹¥æ˜¯å¦‚æ­¤ï¼Œç»ˆæœ‰æ‰€è·ã€‚
>
> åŸæ–‡ï¼šhttps://mp.weixin.qq.com/s/Fx4AAS5pUqSGtui4Z-LYXA



## ğŸˆ å·å¤–

æœ€è¿‘ï¼Œå…¬ä¼—å·ä¹‹å¤–ï¼Œå»ºç«‹äº†å¾®ä¿¡äº¤æµç¾¤ï¼Œä¸å®šæœŸä¼šåœ¨ç¾¤é‡Œåˆ†äº«å„ç§èµ„æºï¼ˆå½±è§†ã€IT ç¼–ç¨‹ã€è€ƒè¯•æå‡â€¦â€¦ï¼‰&çŸ¥è¯†ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥**æ‰«ç æˆ–è€…åå°æ·»åŠ å°ç¼–å¾®ä¿¡å¤‡æ³¨å…¥ç¾¤**ã€‚è¿›ç¾¤å**ä¼˜å…ˆçœ‹ç¾¤å…¬å‘Š**ï¼Œ**å‘¼å«ç¾¤ä¸­ã€èµ„æºåˆ†äº«å°åŠ©æ‰‹ã€‘**ï¼Œè¿˜èƒ½å…è´¹å¸®æ‰¾èµ„æºå“¦ï½

<center>
<img src="/contact/wxgroup.jpg" width="150"> 
</center>

## ä¸€ã€ç®€ä»‹

### 1. ä»€ä¹ˆæ˜¯ Nginx

`Nginx` æ˜¯ä¸€ä¸ªè·¨å¹³å°ã€è½»é‡çº§ã€é«˜æ€§èƒ½çš„ `HTTP` å’Œåå‘ä»£ç† `web` æœåŠ¡å™¨ï¼Œè€Œä¸”åŒæ—¶ä¹Ÿæä¾›äº† `IMAP/POP3/SMTP` æœåŠ¡ã€‚`Nginx` æœ€é«˜èƒ½å¤Ÿæ”¯æŒæåˆ° 50000 å“¥å¹¶å‘è¿æ¥æ•°çš„ç›¸åº”ï¼Œåœ¨æœ€é«˜å¹¶å‘è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½œä¸º `Apache` æœåŠ¡çš„ä¸€ä¸ªæ›¿ä»£å“ã€‚

`Nginx` ä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡ï¼Œæ—¢å¯ä»¥åœ¨å†…éƒ¨ç›´æ¥æ”¯æŒ `Redis` å’Œ `PHP` ç¨‹åºå¯¹å¤–è¿›è¡ŒæœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ”¯æŒ `HTTP` ä»£ç†æœåŠ¡å¯¹å¤–è¿›è¡Œæ”¯æŒã€‚`Nginx` æ˜¯åŸºäº C è¯­è¨€æ¥è¿›è¡Œå¼€å‘çš„ï¼Œæ‰€ä»¥æ— è®ºæ˜¯ç³»ç»Ÿèµ„æºå¼€é”€è¿˜æ˜¯ CPU ä½¿ç”¨ç‡éƒ½è¾ƒä½ï¼Œä¹Ÿå› æ­¤ `Nginx` æ€§èƒ½è¾ƒå¼ºã€‚
### 2. Nginx çš„ç‰ˆæœ¬

å¸¸ç”¨ç‰ˆæœ¬ä¸»è¦åˆ†ä¸ºå››å¤§é˜µè¥ï¼š

1.   `Nginx` å¼€æºç‰ˆ
2.   `Nginx plus` å•†ä¸šç‰ˆ
3.   `Openresty`
4.   `Tengine`

## äºŒã€ä¸‹è½½

ä¸Šä¸€èŠ‚ä¸­æˆ‘ä»¬è®²äº† `Nginx` çš„ä¸€äº›ç®€å•çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥å°±æ¥çœ‹çœ‹ï¼Œå¦‚ä½•åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸­å®‰è£… `Nginx`ã€‚ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å‡ä»¥ `Nginx` å¼€æºç‰ˆåšç¤ºèŒƒã€‚

å‰å¾€ `Nginx` å®˜æ–¹åœ°å€ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ï¼Œå› ä¸ºè¿™é‡Œä¸»è¦æ˜¯åœ¨æœåŠ¡å™¨ä¸­å®‰è£…ï¼Œæ‰€ä»¥æ˜¯ä»¥ `Linuxï¼ˆCentosï¼‰` ç‰ˆæœ¬æ¥æ¼”ç¤ºã€‚

>   http://nginx.org/en/download.html

![](assets/82fab0e89c6a42b896b77f98dee94b2c.webp)

## ä¸‰ã€ç¼–è¯‘å®‰è£…ä¸ä¾èµ–æ£€æŸ¥

å°†ä¸‹è½½åçš„ `Nginx` å‹ç¼©åŒ…è¿›è¡Œè§£å‹ï¼Œè§£å‹å‘½ä»¤å¦‚ä¸‹ã€‚

```shell
tar -zxf å‹ç¼©åŒ…å
```
![](assets/2cd8cb2c4221471e89bd6ad9c58269d5.webp)
è¿›å…¥è§£å‹ç¼©åçš„ `Nginx` æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œç„¶åæ‰§è¡Œ `configure` è„šæœ¬ï¼Œè¿™æ—¶å€™å°±ä¼šæ£€æŸ¥å®‰è£… `Nginx` æ‰€éœ€çš„ä¾èµ–ï¼Œè¿™é‡Œå¯èƒ½ä¼šå› ä¸ºä½ çš„æœåŠ¡å™¨ä¸­æ²¡æœ‰äº‹å…ˆå®‰è£…æ‰€éœ€ä¾èµ–è€Œå¯¼è‡´æŠ¥é”™ã€‚

```shell
cd nginx-1.22.0
sh configure
```
![](assets/16c89775141f40f9a69cdb9980bd221b.webp)


è¿™é‡Œä¾‹ä¸¾å‡ ä¸ªå®‰è£…æ—¶å¯èƒ½ä¼šé‡åˆ°çš„é”™è¯¯ï¼š

1. **C ç¼–è¯‘å™¨ç¼ºå¤±**

```shell
error: C compiler cc is not found.
```

è¦è§£å†³è¿™ä¸ªé”™è¯¯ï¼Œåªéœ€è¦å®‰è£… `gcc` ç¼–è¯‘å™¨å³å¯ã€‚

```shell
yum install -y gcc
```

2. **PCRE Library ç¼ºå¤±**

```shell
error: the HTTP rewrite module requires the PCRE library.
```
åŒæ ·ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªè¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å®‰è£… `pcre-devel`ã€‚

```shell
yum install -y pcre pcre-devel
```

3. **zlib Library ç¼ºå¤±**

```shell
error: the HTTP gzip module requires zlib library.
```
è§£å†³æ–¹æ³•ï¼Œå®‰è£… `zlib` åº“ã€‚

```shell
yum install -y zlib zlib-devel
```

![](assets/e0c9acc5f35e447591b2b6d2df12755b.webp)
å¦‚æœå‡ºç°ä»¥ä¸Šçš„æç¤ºä¿¡æ¯ï¼Œåˆ™è¯´æ˜å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œæ­¤æ—¶ç›´æ¥æ‰§è¡Œç¼–è¯‘å®‰è£…å‘½ä»¤ã€‚

```shell
make

make install
```
![](assets/73fa2a756cd54177ac55cfd17b34d9f1.webp)
![](assets/991d0ce06dc6480d97abf8b858b93030.webp)

## å››ã€Nginx å¯åœ


å¦‚æœé¡ºåˆ©æ‰§è¡Œå®Œ `configure` è„šæœ¬ï¼Œåˆ™ä¼šåœ¨æœåŠ¡å™¨ç»ˆç«¯æ‰“å°å‡ºä»¥ä¸Š `Nginx` ç›¸å…³çš„é…ç½®ã€‚

è¿›å…¥ `Nginx` å®‰è£…åçš„ç›®å½• `/usr/local/nginx/sbin`ï¼Œç„¶ååˆ©ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è¿›è¡Œ `Nginx` çš„å¯åŠ¨ã€‚

### 1. å¯åŠ¨

```shell
./nginx
```
![](assets/70fc81bab6ce4aeb9618e27ba081469d.webp)
ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—®æœåŠ¡å™¨çš„ `IP` åœ°å€ï¼Œå¦‚æœå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼Œåˆ™è¯´æ˜æˆ‘ä»¬çš„ `Nginx` å®‰è£…å¹¶å¯åŠ¨æˆåŠŸäº†ï¼

![](assets/7a61140a0a464a81a27e348e1b284ac6.webp)

### 2. å¿«é€Ÿåœæ­¢

```shell
./nginx -s stop
```
åœæ­¢åï¼Œå†åˆ°æµè§ˆå™¨ä¸­å»è®¿é—®æœåŠ¡å™¨åœ°å€ï¼Œå°±ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µã€‚

![](assets/7205270749fb4e5ab06423dc6920891c.webp)

### 3. å…³é—­å‰å®Œæˆå·²æ¥å—çš„è¿æ¥è¯·æ±‚

```shell
./nginx -s quit
```

### 4. é‡æ–°åŠ è½½é…ç½®

```shell
./nginx -s reload
```

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å®ç° `Nginx` çš„æ— æ„Ÿé‡å¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¿®æ”¹ `Nginx` çš„é…ç½®æ—¶ï¼Œä¸å¸Œæœ›é€šè¿‡åœæ­¢ `Nginx` ç„¶ååœ¨å¯åŠ¨çš„æ–¹å¼ï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå‘½ä»¤æ¥å®ç°ã€‚

## äº”ã€é˜²ç«å¢™

### 1. å…³é—­é˜²ç«å¢™

```shell
systemctl stop firewall.service
```

### 2. ç¦æ­¢é˜²ç«å¢™å¼€æœºå¯åŠ¨

```shell
systemctl disable firewall.service
```
### 3. æ”¾è¡Œç«¯å£

```shell
firewall-cmd --zone=public --add-port=80/tcp --permanent
```

### 4. é‡å¯é˜²ç«å¢™

```shell
firewall-cmd reload
```

## äº”ã€å®‰è£…ä¸ºç³»ç»ŸæœåŠ¡

### 1. æ·»åŠ ç³»ç»ŸæœåŠ¡

åœ¨ `/usr/lib/systemd/system` ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸º `nginx.service`ï¼Œç„¶åå°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚

```shell
[Unit]
Description=nginx - high performance web server
Documentation=http://nginx.org/en/docs/
After=network.target remote-fs.target nss-lookup.target
 
[Service]
Type=forking
PIDFile=/usr/local/nginx/logs/nginx.pid
ExecStartPre=/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf
ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf
ExecReload=/bin/kill -s HUP $MAINPID
ExecStop=/bin/kill -s QUIT $MAINPID
PrivateTmp=true
 
[Install]
WantedBy=multi-user.target
```

### 2. é‡è½½ç³»ç»ŸæœåŠ¡

æ¥ç€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°åŠ è½½ç³»ç»ŸæœåŠ¡ã€‚

```shell
systemctl daemon-reload
```

### 3. å¯åœ Nginx

æ¥ç€å°±å¯ä»¥åˆ†åˆ«åˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å¯åŠ¨å’Œå…³åœ `Nginx` æœåŠ¡äº†ã€‚

- å¯åŠ¨

```shell
systemctl start nginx
```
- å…³åœ

```shell
systemctl stop nginx
```
- æŸ¥çœ‹å½“å‰çŠ¶æ€

```shell
systemctl status nginx
```

![](assets/06e3119f7e4b4e7096b3ce9e85387613.webp)
## å…­ã€æ€»ç»“

ä»¥ä¸Šå°±æ˜¯ `Nginx` çš„ç®€ä»‹å’Œå¦‚ä½•åœ¨ Linux ä¸­å®‰è£… `Nginx` çš„ç›¸å…³å†…å®¹äº†ï¼Œå¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œè¿˜è¯·æ¥ä¸ªä¸€é”®ä¸‰è¿æ”¯æŒæŠŠï¼

## â³ è”ç³»

æƒ³è§£é”æ›´å¤šçŸ¥è¯†ï¼Ÿä¸å¦¨å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼š**æ‘é›¨é¥ï¼ˆidï¼šJavaParkï¼‰**ã€‚

æ‰«ä¸€æ‰«ï¼Œæ¢ç´¢å¦ä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œã€‚

<center>
<img src="/contact/contact.png" width="300">
</center>