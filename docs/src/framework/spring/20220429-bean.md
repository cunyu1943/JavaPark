---
isOriginal: true
category: Spring ç³»åˆ—
tag:
    - Spring
date: 2022-04-29
---

# Bean è¯¦è§£

## ğŸˆ å·å¤–

æœ€è¿‘ï¼Œå…¬ä¼—å·ä¹‹å¤–ï¼Œå»ºç«‹äº†å¾®ä¿¡äº¤æµç¾¤ï¼Œä¸å®šæœŸä¼šåœ¨ç¾¤é‡Œåˆ†äº«å„ç§èµ„æºï¼ˆå½±è§†ã€IT ç¼–ç¨‹ã€è€ƒè¯•æå‡â€¦â€¦ï¼‰&çŸ¥è¯†ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥**æ‰«ç æˆ–è€…åå°æ·»åŠ å°ç¼–å¾®ä¿¡å¤‡æ³¨å…¥ç¾¤**ã€‚è¿›ç¾¤å**ä¼˜å…ˆçœ‹ç¾¤å…¬å‘Š**ï¼Œ**å‘¼å«ç¾¤ä¸­ã€èµ„æºåˆ†äº«å°åŠ©æ‰‹ã€‘**ï¼Œè¿˜èƒ½å…è´¹å¸®æ‰¾èµ„æºå“¦ï½

<center>
<img src="/contact/wxgroup.jpg" width="150"> 
</center>

##  Bean çš„åˆ«åé…ç½®

æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„ `<bean>` é…ç½®ï¼Œå…¶ä¸­é…ç½®äº† `id` å±æ€§ï¼Œé€šè¿‡ `id` å±æ€§æˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°å¯¹è±¡ã€‚å…¶å® `<bean>` é…ç½®ä¹Ÿæä¾›äº† `name` å±æ€§ï¼Œå®ƒæ˜¯ç”¨äºå®šä¹‰ Bean çš„åˆ«åï¼Œä¸€ä¸ª Bean çš„åˆ«åæ˜¯å¯ä»¥æœ‰å¤šä¸ªçš„ï¼Œå„ä¸ªåˆ«åä¹‹é—´å¯ä»¥é€šè¿‡é€—å·ï¼ˆ`,`ï¼‰ã€åˆ†å·ï¼ˆ`;`ï¼‰ã€ç©ºæ ¼ï¼ˆ` `ï¼‰åˆ†éš”ã€‚

```xml
<!--  é…ç½® bean  -->
<bean id="bookDao" name="dao bookDaoImpl" class="com.cunyu.dao.impl.BookDaoImpl"/>
<bean id="bookService" name="service,bookServiceImpl" class="com.cunyu.service.impl.BookServiceImpl">
    <!-- property è¡¨ç¤ºé…ç½®å½“å‰ Bean çš„å±æ€§
             name è¡¨ç¤ºé…ç½®å“ªä¸€ä¸ªå…·ä½“çš„å±æ€§
             ref è¡¨ç¤ºå‚ç…§çš„ Bean
             -->
    <property name="bookDao" ref="bookDao"/>
</bean>
```

å½“æˆ‘ä»¬è¦è·å– Bean æ—¶ï¼Œæ—¢å¯ä»¥é€šè¿‡ `id`ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `name` è·å–ã€‚ä¸¤è€…çš„åŒºåˆ«åœ¨äº `id` å±æ€§æ˜¯æƒŸä¸€çš„ï¼Œè€Œ `name` ä¸æ˜¯ï¼Œå› æ­¤åœ¨é…ç½®æ—¶ï¼Œæ›´åŠ æ¨èä½¿ç”¨ `id` è€Œé `name` é˜²æ­¢å› ä¸ºé‡åè€Œå¯¼è‡´åœ¨è·å– Bean æ—¶æ··æ·†ã€‚

é€šè¿‡ `id` æˆ–è€… `name` è·å– Bean æ—¶ï¼Œå¦‚æœè·å–ä¸åˆ°ï¼Œæ­¤æ—¶ç¨‹åºå°†æŠ›å‡ºå¼‚å¸¸ `NoSuchBeanDefinitionException`ã€‚

```sh
NoSuchBeanDefinitionException: No bean named 'xxx' available
```

ä¸€æ—¦é‡åˆ°ä»¥ä¸Šé”™è¯¯ï¼Œé‚£ä¹ˆç¬¬ä¸€ååº”åº”è¯¥æ˜¯æ˜¯å» Spring é…ç½®æ–‡ä»¶ `applicationContext.xml` ä¸­æŸ¥çœ‹å¯¹åº” Bean æ˜¯å¦é…ç½®ï¼Œæˆ–è€…åœ¨ä»£ç å’Œé…ç½®ä¸­çš„ Bean åæ˜¯å¦åŒ¹é…ä¸€è‡´ã€‚

## Bean çš„ä½œç”¨èŒƒå›´

Bean æ—¢ç„¶æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒä¹Ÿæ˜¯æœ‰ä½œç”¨èŒƒå›´çš„ã€‚åœ¨ `<bean>` é…ç½®æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ `scope` å±æ€§ã€‚

| å€¼          | è¯´æ˜                           |
| ----------- | ------------------------------ |
| `singleton` | å•ä¾‹ï¼Œä¹Ÿæ˜¯ Bean ç£¨äººçš„ä½œç”¨èŒƒå›´ |
| `prototype` | éå•ä¾‹                         |

```xml
<bean id="bookService" class="com.cunyu.service.impl.BookServiceImpl" />
```

```xml
<bean id="bookService" class="com.cunyu.service.impl.BookServiceImpl" scope="singleton"/>
```

ä»¥ä¸Šä¸¤ç§é…ç½®çš„æ•ˆæœæ˜¯ä¸€è‡´çš„ï¼Œå› ä¸º Bean é»˜è®¤çš„ä½œç”¨èŒƒå›´æ˜¯ `singleton`ã€‚æ¥ç€æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ª `BookService` å¯¹è±¡ï¼Œç„¶åæ‰“å°å‡ºæ¥ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä»¬æŒ‡å‘çš„æ˜¯åŒä¸€å—å†…å­˜ã€‚

```java
public class AppIoC {
    public static void main(String[] args) {
        //    åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å– IoC å®¹å™¨
        ApplicationContext app = new ClassPathXmlApplicationContext("applicationContext.xml");

        BookService bookService1 = (BookService) app.getBean("bookService");
        BookService bookService2 = (BookService) app.getBean("bookService");
        System.out.println(bookService1);
        System.out.println(bookService2);
    }
}
```



![](assets/20220429-bean/23274c95c22d506fe28d07e59058881b.webp)

è€Œå¦‚æœæˆ‘ä»¬å°† Bean çš„ `scope` é…ç½®ä¸º `prototype`ï¼Œé‚£ä¹ˆæ­¤æ—¶å†åˆ›å»ºä¸¤ä¸ª `BookService` å¯¹è±¡ï¼Œç„¶åå¯¹æ¯”å®ƒä»¬çš„å†…å­˜åœ°å€ï¼Œä¼šå‘ç°ä¸¤è€…æŒ‡å‘çš„å¹¶éæŒ‡å‘åŒä¸€å—å†…å­˜ã€‚

```xml
<bean id="bookService" class="com.cunyu.service.impl.BookServiceImpl" scope="prototype"/>
```



```java
public class AppIoC {
    public static void main(String[] args) {
        //    åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å– IoC å®¹å™¨
        ApplicationContext app = new ClassPathXmlApplicationContext("applicationContext.xml");

        BookService bookService1 = (BookService) app.getBean("bookService");
        BookService bookService2 = (BookService) app.getBean("bookService");
        System.out.println(bookService1);
        System.out.println(bookService2);
    }
}
```

![](assets/20220429-bean/762db86a1a56da40cad36f0adefab25e.webp)

## Bean å®ä¾‹åŒ–

### æ„é€ æ–¹æ³•

Bean çš„æœ¬è´¨æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ„é€ æ–¹æ³•å®Œæˆã€‚

åŒæ ·åŸºäºä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„å®ä¾‹ï¼Œé…ç½®å¥½ `<bean>` ä¹‹åï¼Œç„¶ååœ¨ `BookDao` æ¥å£çš„å®ç°ä¸­ç”¨æ„é€ æ–¹æ³•æ¥åˆ›å»º Beanï¼Œæœ€ååœ¨ä¸»ç¨‹åºå…¥å£ä¸­è·å– Bean ä¹‹åè°ƒç”¨æ–¹æ³•ï¼Œå¯ä»¥å‘ç°è°ƒç”¨äº†æ„é€ æ–¹æ³•ã€‚

```xml
<bean id="bookDao" class="com.cunyu.dao.impl.BookDaoImpl"/>
```

```java
public class BookDaoImpl implements BookDao {
    private BookDaoImpl() {
        System.out.println("æ„é€ æ–¹æ³•");
    }

    @Override
    public void save() {
        System.out.println("book dao save â€¦â€¦");
    }
}
```



```java
public class AppIoC {
    public static void main(String[] args) {
        //    åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å– IoC å®¹å™¨
        ApplicationContext app = new ClassPathXmlApplicationContext("applicationContext.xml");
        //    è·å– Bean
        BookDao bookDao = (BookDao) app.getBean("bookDao");
        bookDao.save();
    }
}


```



![](assets/20220429-bean/738ba175ae38bd9eecce821a88b15b63.webp)

### é™æ€å·¥å‚æ–¹æ³•

åˆ©ç”¨é™æ€å·¥å‚æ–¹æ³•å¯¹ Bean è¿›è¡Œå®ä¾‹åŒ–æ—¶ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œå¹¶åœ¨å·¥å‚ç±»ä¸­åˆ›å»ºä¸€ä¸ªé™æ€æ–¹æ³•ç”¨äºåˆ›å»ºå¯¹è±¡ã€‚ç„¶ååœ¨ Spring çš„é…ç½®æ–‡ä»¶ `applicationContext.xml` ä¸­é…ç½®é™æ€å·¥å‚ç±»å¹¶æŒ‡å®šå…¶ä¸­çš„æ–¹æ³•ï¼Œæœ€ååœ¨ä¸»ç¨‹åºå…¥å£ä¸­è·å– Bean å¹¶è°ƒç”¨æ–¹æ³•å³å¯ã€‚

```java
public class BookDaoFactory {
    public static BookDao getBookDao() {
        return new BookDaoImpl();
    }
}
```

```xml
<bean id="bookDao" factory-method="getBookDao" class="com.cunyu.factory.BookDaoFactory"/>
```

```java
public class AppIoC {
    public static void main(String[] args) {
        //    åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å– IoC å®¹å™¨
        ApplicationContext app = new ClassPathXmlApplicationContext("applicationContext.xml");
        //    è·å– Bean
        BookDao bookDao = (BookDao) app.getBean("bookDao");
        bookDao.save();
    }
}

```

![](assets/20220429-bean/7efc979cde7f61adecf59e1505011624.webp)

### å®ä¾‹å·¥å‚å¯¹è±¡æ–¹æ³• 

å‡è®¾æœ‰ä¸€ä¸ªæ¥å£å’Œå®ƒçš„å®ç°å¦‚ä¸‹ï¼š

```java
public interface PersonDao {
    public void query();
}
```

```java
public class PersonDaoImpl implements PersonDao {
    @Override
    public void query() {
        System.out.println("Person Dao queryâ€¦â€¦");
    }
}
```

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®ä¾‹å·¥å‚æ–¹æ³•ï¼Œæ³¨æ„æ­¤æ—¶æˆ‘ä»¬æ˜¯ç»§æ‰¿äº† `FactoryBean` æ¥å£ï¼Œç„¶åå®ç°äº†å…¶ä¸­çš„ `getObject()` å’Œ `getObjectType()` ä¸¤ä¸ªæ–¹æ³•ã€‚

```java
public class PersonDaoFactoryBean implements FactoryBean<PersonDao> {
    @Override
    public PersonDao getObject() throws Exception {
        return new PersonDaoImpl();
    }

    @Override
    public Class<?> getObjectType() {
        return PersonDao.class;
    }
}
```

æ¥ç€åœ¨ Spring çš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œéœ€è¦æ³¨æ„æ­¤æ—¶çš„ç±»åº”è¯¥æ˜¯æˆ‘ä»¬çš„å·¥å‚ç±» `PersonDaoFactoryBean`ï¼Œè€Œä¸æ˜¯ `PersonDaoImpl`ã€‚

```xml
<bean id="personDao" class="com.cunyu.factory.PersonDaoFactoryBean"/>
```

æœ€ååœ¨ç¨‹åºä¸»å…¥å£ä¸­è·å– Beanï¼Œç„¶åè°ƒç”¨æ–¹æ³•å³å¯ã€‚

```java
public class AppIoC {
    public static void main(String[] args) {
        //    åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å– IoC å®¹å™¨
        ApplicationContext app = new ClassPathXmlApplicationContext("applicationContext.xml");
        //    è·å– Bean
        PersonDao personDao = (PersonDao) app.getBean("personDao");
        personDao.query();
    }
}
```

![](assets/20220429-bean/0a92ceb6def8add5e0bf5283576fc511.webp)

## Bean çš„ç”Ÿå‘½å‘¨æœŸ

å…ˆæ¥çœ‹çœ‹ç”Ÿå‘½å‘¨æœŸçš„å®šä¹‰ï¼Œæ‰€è°“ç”Ÿå‘½å‘¨æœŸå°±æ˜¯æŒ‡ä»åˆ›å»ºåˆ°æ¶ˆäº¡çš„å®Œæ•´è¿‡ç¨‹ï¼Œç±»æ¯”åˆ°æˆ‘ä»¬äººèº«ä¸Šï¼Œç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä»æˆ‘ä»¬å‡ºç”Ÿåˆ°æ­»äº¡çš„è¿™ä¸ªè¿‡ç¨‹ã€‚è€Œ Bean çš„ç”Ÿå‘½å‘¨æœŸå°±æŒ‡çš„æ˜¯ Bean ä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä½“è¿‡ç¨‹ã€‚

Bean çš„ç”Ÿå‘½å‘¨æœŸä¸»è¦åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

-   **åˆå§‹åŒ–å®¹å™¨**
-   **ä½¿ç”¨ Bean**
-   **é”€æ¯å®¹å™¨**

åˆå§‹åŒ–å®¹å™¨é˜¶æ®µï¼Œä¸»è¦æ‰§è¡Œçš„æ“ä½œæœ‰ï¼šåˆ›å»ºå¯¹è±¡ï¼ˆå†…å­˜åˆ†é…ï¼‰ã€æ‰§è¡Œæ„é€ æ–¹æ³•ã€æ‰§è¡Œå±æ€§æ³¨å…¥ï¼ˆ`set` æ“ä½œï¼‰ã€æ‰§è¡Œ Bean åˆå§‹åŒ–æ–¹æ³•ã€‚

ä½¿ç”¨ Bean é˜¶æ®µï¼Œä¸»è¦æ˜¯å»æ‰§è¡Œä¸šåŠ¡æ“ä½œã€‚

é”€æ¯å®¹å™¨é˜¶æ®µï¼Œä¸»è¦æ˜¯æ‰§è¡Œ Bean çš„é”€æ¯æ–¹æ³•ã€‚

## æ€»ç»“

ä»¥ä¸Šå°±æ˜¯ä»Šå¤©å…³äº Bean çš„å†…å®¹äº†ï¼Œä¸»è¦ä» Bean çš„åˆ«åé…ç½®ã€ä½œç”¨èŒƒå›´ã€å¦‚ä½•è¿›è¡Œå®ä¾‹åŒ–ä»¥åŠå£°æ˜å‘¨æœŸ 4 ä¸ªæ–¹é¢ç€æ‰‹ï¼Œå­¦ä¹ äº† Bean çš„ç›¸å…³æ“ä½œã€‚
