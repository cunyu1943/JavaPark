---
isOriginal: true
category: Spring ç³»åˆ—
tag:
    - Spring
---

# IoC å¤§æ­ç§˜

> ä½œè€…ï¼š[æ‘é›¨é¥](https://github.com/cunyu1943)
> 
> ä¸è¦å“€æ±‚ï¼Œå­¦ä¼šäº‰å–ï¼Œè‹¥æ˜¯å¦‚æ­¤ï¼Œç»ˆæœ‰æ‰€è·
>

## ğŸˆ å·å¤–

æœ€è¿‘ï¼Œå…¬ä¼—å·ä¹‹å¤–ï¼Œå»ºç«‹äº†å¾®ä¿¡äº¤æµç¾¤ï¼Œä¸å®šæœŸä¼šåœ¨ç¾¤é‡Œåˆ†äº«å„ç§èµ„æºï¼ˆå½±è§†ã€IT ç¼–ç¨‹ã€è€ƒè¯•æå‡â€¦â€¦ï¼‰&çŸ¥è¯†ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥**æ‰«ç æˆ–è€…åå°æ·»åŠ å°ç¼–å¾®ä¿¡å¤‡æ³¨å…¥ç¾¤**ã€‚è¿›ç¾¤å**ä¼˜å…ˆçœ‹ç¾¤å…¬å‘Š**ï¼Œ**å‘¼å«ç¾¤ä¸­ã€èµ„æºåˆ†äº«å°åŠ©æ‰‹ã€‘**ï¼Œè¿˜èƒ½å…è´¹å¸®æ‰¾èµ„æºå“¦ï½

<center>
<img src="/contact/wxgroup.jpg" width="150"> 
</center>

## 1. ä»€ä¹ˆæ˜¯ Ioc

### 1.1 Ioc å®šä¹‰

Iocï¼ˆInversion of Controlï¼‰ï¼Œå³ **æ§åˆ¶åè½¬**ï¼Œæ˜¯ Spring æ¡†æ¶çš„æ ¸å¿ƒå†…å®¹ï¼Œå®é™…ä¸ŠæŒ‡çš„æ˜¯ **å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ§åˆ¶æƒçš„åè½¬**ï¼Œå’Œ OOP ä¸€æ ·ï¼Œå±äºä¸€ç§è®¾è®¡æ€æƒ³ã€‚Ioc è¡¨ç¤ºå°†æˆ‘ä»¬ **è®¾è®¡å¥½çš„å¯¹è±¡äº¤ç”±å®¹å™¨æ§åˆ¶**ï¼Œè€Œ **ä¸å†ä½¿ç”¨åœ¨å¯¹è±¡å†…éƒ¨ç›´æ¥æ§åˆ¶** è¿™ç§ä¼ ç»Ÿæ–¹å¼ï¼Œè€Œ **DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰åˆ™æ˜¯å®ç° Ioc çš„ä¸€ç§æ–¹æ³•**ã€‚

### 1.2 Ioc å·¥ä½œæµç¨‹

Spring Ioc å®¹å™¨åœ¨åˆå§‹åŒ–æ—¶å…ˆè¯»å–é…ç½®æ–‡ä»¶ï¼Œç„¶åæ ¹æ®é…ç½®æˆ–å…ƒæ•°æ®æ¥åˆ›å»ºä¸ç»„ç»‡å¯¹è±¡å­˜å…¥å®¹å™¨ä¸­ï¼Œå½“ç¨‹åºè¦ä½¿ç”¨æ—¶å†ä» Ioc å®¹å™¨ä¸­è¯»å–å‡ºéœ€è¦çš„å¯¹è±¡ã€‚

![](assets/20200723-ioc/1.webp)


## 2. Ioc å®ä¾‹

### 2.1 é¡¹ç›®åˆ›å»º

1.  åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œç„¶ååœ¨ `pom.xml` ä¸­å¼•å…¥ `spring-context` ä»¥åŠ `Junit` çš„ä¾èµ–ï¼›

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>5.2.7.RELEASE</version>
    </dependency>

    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.13</version>
        <scope>test</scope>
    </dependency>
</dependencies>
```

2.  åœ¨ `resourcees` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª Spring çš„é…ç½®æ–‡ä»¶ï¼Œç„¶åä¼šç”Ÿæˆå¦‚ä¸‹åŒ…å«å†…å®¹çš„æ¨¡æ¿ï¼›

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

</beans>
```

3.  Spring é…ç½®æ–‡ä»¶åˆ›å»ºå¥½ä¹‹åï¼Œå°±å¯ä»¥åœ¨å…¶ä¸­é…ç½®æˆ‘ä»¬éœ€è¦æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­çš„ Beanï¼Œå…¶ä¸­ `class` å±æ€§ç”¨äºè¡¨ç¤ºè¦æ³¨å†Œçš„ Bean çš„å…¨è·¯å¾„ï¼Œè€Œ `id` åˆ™æ˜¯ Bean çš„å”¯ä¸€æ ‡è¯†ã€‚

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean class="com.cunyu.domain.Book" id="book"/>
</beans>
```

æ­¤å¤„é…ç½®çš„æ˜¯ `com.cunyu.domain` åŒ…ä¸‹çš„ `Book` ç±»ï¼Œæ‰€ä»¥éœ€è¦å¯¹åº”æºæ–‡ä»¶å­˜åœ¨ï¼Œæˆ‘çš„ `Book` ç±»å®šä¹‰å¦‚ä¸‹ï¼š

```java
package com.cunyu.domain;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : Book
 * @date : 2020/7/7 14:10
 * @description : Book ç±»
 */

public class Book {
    private Integer id;
    private String name;
    private Double price;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Double getPrice() {
        return price;
    }

    public void setPrice(Double price) {
        this.price = price;
    }
}
```

4.  å¥½äº†ï¼Œå®Œæˆä¸Šé¢çš„é…ç½®ä¹‹åï¼Œæˆ‘ä»¬çš„ Bean å°±å·²ç»è¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­äº†ï¼Œæ¥ä¸‹æ¥åªéœ€è¦åŠ è½½è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨ `getBean()` æ–¹æ³•ä»å®¹å™¨ä¸­è·å–å¯¹è±¡å³å¯ï¼›

```java
import com.cunyu.domain.Book;
import org.springframework.context.support.ClassPathXmlApplicationContext;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : Main
 * @date : 2020/7/7 14:12
 * @description : åŠ è½½ Spring é…ç½®æ–‡ä»¶
 */

public class TestBook {
    @Test
    public void test(){
        ClassPathXmlApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");
        Book book = (Book) applicationContext.getBean("book");
        System.out.println(book);
    }
}

```

### 2.2 æ³¨æ„äº‹é¡¹

é™¤å¼€ä¸Šè¿° `ClassPathXmlApplicationContext` çš„æ–¹å¼åŠ è½½é…ç½®æ–‡ä»¶ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ `FileSystemXmlApplicationContext` çš„æ–¹å¼ï¼Œè¿™æ ·çš„è¯é¡¹ç›®å°†ä¼šä»ç»™å®šçš„è·¯å¾„ä¸­å»åŠ è½½é…ç½®æ–‡ä»¶ã€‚

```java
public class Main {
    public static void main(String[] args) {
        FileSystemXmlApplicationContext ctx = new FileSystemXmlApplicationContext("/home/cunyu/IDEA/spring-ioc/src/main/resources/applicationContext.xml");
        Book book = (Book) ctx.getBean("book");
        System.out.println(book);
    }
}
```

æ­¤å¤–ï¼Œä¸ä»…å¯ä»¥ç”¨ `getBean()` æ–¹æ³•æ¥è·å– Beanï¼Œè¿˜å¯ä»¥ç›´æ¥é€šè¿‡ `Class` æ¥è·å– Beanï¼Œä½†æ­¤æ—¶è¦æ±‚ Bean åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹ï¼Œå¦åˆ™å°±ä¼šå¯¼è‡´æŠ¥é”™ã€‚æ¯”å¦‚ä¸‹é¢çš„æƒ…å†µå°±ä¼šå¯¼è‡´æŠ¥é”™ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean class="com.cunyu.domain.Book" id="book1"/>
    <bean class="com.cunyu.domain.Book" id="book2"/>
</beans>
```