---
isOriginal: true
category: Spring ç³»åˆ—
tag:
    - Spring
---

# ä¾èµ–æ³¨å…¥çŸ¥å¤šå°‘

## ğŸˆ å·å¤–

æœ€è¿‘ï¼Œå…¬ä¼—å·ä¹‹å¤–ï¼Œå»ºç«‹äº†å¾®ä¿¡äº¤æµç¾¤ï¼Œä¸å®šæœŸä¼šåœ¨ç¾¤é‡Œåˆ†äº«å„ç§èµ„æºï¼ˆå½±è§†ã€IT ç¼–ç¨‹ã€è€ƒè¯•æå‡â€¦â€¦ï¼‰&çŸ¥è¯†ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥**æ‰«ç æˆ–è€…åå°æ·»åŠ å°ç¼–å¾®ä¿¡å¤‡æ³¨å…¥ç¾¤**ã€‚è¿›ç¾¤å**ä¼˜å…ˆçœ‹ç¾¤å…¬å‘Š**ï¼Œ**å‘¼å«ç¾¤ä¸­ã€èµ„æºåˆ†äº«å°åŠ©æ‰‹ã€‘**ï¼Œè¿˜èƒ½å…è´¹å¸®æ‰¾èµ„æºå“¦ï½

<center>
<img src="/contact/wxgroup.jpg" width="150"> 
</center>

## 0. å‰è¨€

Spring ä¸­ï¼Œç”¨æ¥ç»„æˆåº”ç”¨ç¨‹åºçš„ä¸»ä½“ä»¥åŠç”± Spring IoC å®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡å«åš Beanã€‚ç®€è€Œè¨€ä¹‹ï¼ŒBean å°±æ˜¯ç”± IoC å®¹å™¨æ¥è¿›è¡Œåˆå§‹åŒ–ã€è£…é…å’Œç®¡ç†çš„å¯¹è±¡ã€‚

Bean çš„ä½œç”¨åŸŸä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§ï¼š

### 0.1 Singleton

ä½œç”¨åŸŸä¸º `Singleton`ï¼Œè¡¨æ˜ IoC å®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº« Bean å®ä¾‹ï¼Œè€Œä¸”æ‰€æœ‰å¯¹ Bean çš„è¯·æ±‚ï¼Œä¸»è¦ `id` å’Œè¯¥ Bean å®šä¹‰ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å› Bean çš„åŒä¸€å®ä¾‹ã€‚`Singleton` æ˜¯å•ä¾‹æ¨¡å‹ï¼Œå³åœ¨ä»åˆ›å»ºå®¹å™¨çš„åŒæ—¶å°±ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Bean çš„å¯¹è±¡ï¼Œæ— è®ºæ˜¯å¦ä½¿ç”¨ï¼Œè€Œä¸”æ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½æ˜¯åŒä¸€å¯¹è±¡ã€‚

### 0.2 Prototype

ä½œç”¨åŸŸä¸º `Prototype`ï¼Œè¡¨æ˜ä¸€ä¸ª Bean å®šä¹‰å¯¹åº”å¤šä¸ªå®ä¾‹ï¼Œè¯¥ä½œç”¨åŸŸä¸­çš„ Bean ä¼šå¯¼è‡´åœ¨æ¯æ¬¡å¯¹è¯¥ Bean è¯·æ±‚æ—¶å‡åˆ›å»ºä¸€ä¸ªæ–°çš„ Bean å®ä¾‹ã€‚`Prototype` æ˜¯ä¸€ä¸ªåŸå‹ç±»å‹ï¼Œåœ¨æˆ‘ä»¬åˆ›å»ºå®¹å™¨æ—¶å¹¶æœªå®ä¾‹åŒ–ï¼Œè€Œæ˜¯å½“æˆ‘ä»¬è·å– Bean æ—¶æ‰å»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”æ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½ä¸ä¸€æ ·ã€‚

### 0.3 Request

ä½œç”¨åŸŸä¸º `Request`ï¼Œè¡¨æ˜åœ¨ä¸€æ¬¡ `HTTP` è¯·æ±‚ä¸­ï¼Œä¸€ä¸ª Bean å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œå³æ¯ä¸ª `HTTP` è¯·æ±‚å‡æœ‰å„è‡ªçš„ Bean å®ä¾‹ï¼Œä¾æ®æŸä¸ª Bean å®šä¹‰åˆ›å»ºè€Œæˆï¼Œåªåœ¨åŸºäº Web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚å½“ä¸€æ¬¡ `HTTP` è¯·æ±‚å¤„ç†ç»“æŸæ—¶ï¼Œè¯¥ä½œç”¨åŸŸä¸­çš„ Bean å®ä¾‹å‡è¢«é”€æ¯ã€‚

### 0.4 Session

ä½œç”¨åŸŸä¸º `Session` ï¼Œè¡¨æ˜åœ¨ä¸€ä¸ª `HTTP Session` ä¸­ï¼Œä¸€ä¸ª Bean å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼Œåªåœ¨åŸºäº Web çš„ Spring ApplicationContext æƒ…å½¢ä¸‹æœ‰æ•ˆã€‚å½“ä¸€ä¸ª `HTTP Session` è¢«åºŸå¼ƒæ—¶ï¼Œåœ¨è¯¥ä½œç”¨åŸŸå†…çš„ Bean ä¹Ÿå°†å¤±æ•ˆã€‚

| ä½œç”¨åŸŸç±»åˆ«  | è¯´æ˜                                                         |
| ----------- | ------------------------------------------------------------ |
| `Singleton` | Spring IoC å®¹å™¨ä¸­ä»…å­˜åœ¨ä¸€ä¸ª Bean å®ä¾‹ï¼Œä»¥å•ä¾‹æ–¹å¼å­˜åœ¨ï¼Œæ˜¯ Spring ä¸­çš„é»˜è®¤å€¼ |
| `Prototype` | æ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨ Bean æ—¶ï¼Œå‡è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå³æ¯æ¬¡è°ƒç”¨ `getBean()` æ–¹æ³•ï¼Œç›¸å½“äº `new` ä¸€ä¸ªæ–°çš„å¯¹è±¡ |
| `Request`   | æ¯æ¬¡ HTTP è¯·æ±‚å‡åˆ›å»ºä¸€ä¸ªæ–°çš„ Beanï¼Œä»…é€‚ç”¨äº WebApplicationContext ç¯å¢ƒ |
| `Session`   | æ¯æ¬¡ HTTP Session å…±äº«ä¸€ä¸ª Beanï¼Œä¸åŒ Session ä½¿ç”¨ä¸åŒçš„ Beanï¼Œä»…é€‚ç”¨äº WebApplicationContext ç¯å¢ƒ |

## 1. ä»€ä¹ˆæ˜¯ DI

DIï¼ˆDependency Injectionï¼‰ï¼Œå³ä¾èµ–æ³¨å…¥ã€‚å…¶ä¸­ **ä¾èµ–æŒ‡çš„æ˜¯ Bean å¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ï¼Œæ˜¯ Bean å¯¹è±¡çš„ä¾èµ–èµ„æºï¼›è€Œæ³¨å…¥åˆ™æŒ‡çš„æ˜¯ Bean å¯¹è±¡æ‰€ä»¥æ¥çš„èµ„æºç”±å®¹å™¨æ¥è®¾ç½®å’Œè£…é…** ã€‚

## 2. å®ç° DI çš„æ–¹å¼

è¦å®ç°ä¾èµ–æ³¨å…¥ï¼Œé€šå¸¸æœ‰å¦‚ä¸‹å‡ ç§æ–¹æ³•ï¼š

1.  **æ„é€ å™¨æ³¨å…¥**
2.  **Set æ³¨å…¥**
3.  **p å‘½åå’Œ c å‘½åæ³¨å…¥**

### 2.1 æ„é€ å™¨æ³¨å…¥

ç”±äºæ„é€ å™¨å¯ä»¥åˆ†ä¸ºæ— å‚å’Œæœ‰å‚æ„é€ å™¨ï¼Œæ‰€æœ‰åˆå¯ä»¥åˆ†ä¸º **æœ‰å‚æ„é€ å™¨æ³¨å…¥** å’Œ **æ— å‚æ„é€ å™¨æ³¨å…¥**ã€‚

#### 2.1.1 æ— å‚æ„é€ å™¨æ³¨å…¥

1.  é¦–å…ˆåˆ›å»ºå®ä½“ç±» `User`

```java
package com.cunyu.pojo;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : User
 * @date : 2020/7/17 14:51
 * @description : TODO
 */

public class User {
    private String name;

    public User() {
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void sayHello() {
        System.out.println("hello," + name);
    }
}

```

2.  æ¥ç€é…ç½® Spring é…ç½®æ–‡ä»¶ï¼Œåœ¨ `resources` ç›®å½•ä¸‹æ–°å»º `applicationContext.xml`

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!--  bean å³ä¸º Java å¯¹è±¡ï¼Œç”± Spring åˆ›å»ºå’Œç®¡ç†  -->
    <bean id="user" class="com.cunyu.pojo.User">
        <property name="name" value="æ‘é›¨é¥"/>
    </bean>
</beans>
```

3.  åˆ©ç”¨ Junit è¿›è¡Œå•å…ƒæµ‹è¯•

```java
package com.cunyu.pojo;

import org.junit.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : HelloTest
 * @date : 2020/7/17 14:56
 * @description : Hello æµ‹è¯•ç±»
 */

public class HelloTest {
    @Test
    public void testSayHello() {
//        è§£æ Spring é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆç®¡ç†ç›¸åº”çš„ Bean å¯¹è±¡
        ApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");
//      getBean() æ–¹æ³•çš„å‚æ•°å³ä¸º Spring é…ç½®æ–‡ä»¶ä¸­ bean çš„ id
        User user = (User) applicationContext.getBean("user");
        user.sayHello();
    }
}
```

#### 2.1.2 æœ‰å‚æ„é€ å™¨æ³¨å…¥

1.  åŒæ ·å…ˆåˆ›å»ºä¸€ä¸ªå®ä½“ç±»ï¼ŒåŒæ—¶æ·»åŠ æœ‰å‚æ„é€ å™¨æ–¹æ³•

```java
package com.cunyu.pojo;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : User
 * @date : 2020/7/17 14:51
 * @description : TODO
 */

public class User {
    private String name;

    public User(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void sayHello() {
        System.out.println("hello," + name);
    }
}

```

2.  é…ç½® Spring é…ç½®æ–‡ä»¶

æ­¤æ—¶é…ç½® Spring é…ç½®æ–‡ä»¶æœ‰ 3 ç§ä¸åŒçš„æ–¹æ³•ï¼š

- é€šè¿‡ `index` ä¸‹æ ‡å±æ€§è®¾ç½®

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <constructor-arg index="0" value="æ‘é›¨é¥"/>
</bean>
```

- é€šè¿‡å‚æ•°åè®¾ç½®

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <constructor-arg name="name" value="æ‘é›¨é¥"/>
</bean>
```

- é€šè¿‡å‚æ•°ç±»å‹è®¾ç½®

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <constructor-arg type="java.lang.String" value="æ‘é›¨é¥"/>
</bean>
```

3.  é€šè¿‡ Junit æµ‹è¯•

```java
package com.cunyu.pojo;

import org.junit.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : HelloTest
 * @date : 2020/7/17 14:56
 * @description : Hello æµ‹è¯•ç±»
 */

public class HelloTest {
    @Test
    public void testSayHello() {
//        è§£æ Spring é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆç®¡ç†ç›¸åº”çš„ Bean å¯¹è±¡
        ApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");
//      getBean() æ–¹æ³•çš„å‚æ•°å³ä¸º Spring é…ç½®æ–‡ä»¶ä¸­ bean çš„ id
        User user = (User) applicationContext.getBean("user");
        user.sayHello();
    }
}
```

### 2.2 Set æ³¨å…¥

è¦æ³¨å…¥æŸå±æ€§ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»æœ‰ `set()` æ–¹æ³•ï¼›

#### 2.2.1 åˆ›å»ºå®ä½“ç±»

```java
package com.cunyu.pojo;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : Address
 * @date : 2020/7/17 16:10
 * @description : åœ°å€ç±»
 */

public class Address {
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }
}
```

```java
package com.cunyu.pojo;

import java.util.List;
import java.util.Properties;
import java.util.Set;
import java.util.Map;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : User
 * @date : 2020/7/17 14:51
 * @description : TODO
 */

public class User {
    private String name;
    private Address address;
    private String[] cars;
    private List<String> pets;
    private Map<String, String> cards;
    private Set<String> games;
    private String girlFriend;
    private Properties info;

    public String getName() {
        return name;
    }

    public Address getAddress() {
        return address;
    }

    public String[] getCars() {
        return cars;
    }

    public List<String> getPets() {
        return pets;
    }

    public Map<String, String> getCards() {
        return cards;
    }

    public Set<String> getGames() {
        return games;
    }

    public String getGirlFriend() {
        return girlFriend;
    }

    public Properties getInfo() {
        return info;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setAddress(Address address) {
        this.address = address;
    }

    public void setCars(String[] cars) {
        this.cars = cars;
    }

    public void setPets(List<String> pets) {
        this.pets = pets;
    }

    public void setCards(Map<String, String> cards) {
        this.cards = cards;
    }

    public void setGames(Set<String> games) {
        this.games = games;
    }

    public void setGirlFriend(String girlFriend) {
        this.girlFriend = girlFriend;
    }

    public void setInfo(Properties info) {
        this.info = info;
    }

    public void display() {
        System.out.println("name = " + name + ", address = " + address.getAddress() + ", cars = ");

        for (String car : cars
        ) {
            System.out.print(car + "\t");
        }

        System.out.println("pets: " + pets);
        System.out.println("card:" + cards);
        System.out.println("games:" + games);
        System.out.println("gf:" + girlFriend);
        System.out.println("info:" + info);
    }
}
```

#### 2.2.2 å„ç±»å‹å±æ€§æ³¨å…¥

1.  å¸¸é‡æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="name" value="æ‘é›¨é¥"/>
</bean>
```

2.  Bean æ³¨å…¥

```xml
<bean id="addr" class="com.cunyu.pojo.Address">
    <property name="address" value="è´µå·"/>
</bean>

<bean id="user" class="com.cunyu.pojo.User">
    <property name="name" value="æ‘é›¨é¥"/>
    <property name="address" ref="addr"/>
</bean>
```

3.  æ•°ç»„æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="cars">
    	<array>
            <value>å¥¥è¿ª</value>
            <value>å°ç‰›</value>
            <value>æ³•æ‹‰åˆ©</value>
    	</array>
    </property>
</bean>
```

4.  List æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="pets">
    	<list>
            <value>çŒ«</value>
            <value>ç‹—</value>
            <value>é¼ </value>
    	</list>
    </property>
</bean>
```

5.  Map æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="cards">
    	<map>
            <entry key="å»ºè¡Œ" value="12345678900"/>
            <entry key="å·¥è¡Œ" value="00987654321"/>
    	</map>
    </property>
</bean>
```

6.  set æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="games">
    	<set>
            <value>GTA5</value>
            <value>Area of Honor</value>
            <value>PUGB</value>
    	</set>
    </property>
</bean>
```

7.  Null æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="girlFriend">
        <null/>
    </property>
</bean>
```

8.  Properties æ³¨å…¥

```xml
<bean id="user" class="com.cunyu.pojo.User">
    <property name="info">
        <props>
            <prop key="å§“å">æ‘é›¨é¥</prop>
            <prop key="è¡€å‹">B</prop>
        </props>
    </property>
</bean>
```

æµ‹è¯•ï¼š

```java
package com.cunyu.pojo;

import org.junit.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : HelloTest
 * @date : 2020/7/17 14:56
 * @description : Hello æµ‹è¯•ç±»
 */

public class HelloTest {
    @Test
    public void test() {
//        è§£æ Spring é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆç®¡ç†ç›¸åº”çš„ Bean å¯¹è±¡
        ApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");
//      getBean() æ–¹æ³•çš„å‚æ•°å³ä¸º Spring é…ç½®æ–‡ä»¶ä¸­ bean çš„ id
        User user = (User) applicationContext.getBean("user");

        user.display();
    }
}
```

![](assets/2020-724-di/format,png.webp)

### 2.3 p å‘½åå’Œ c å‘½åæ³¨å…¥

#### 2.3.1 p å‘½åæ³¨å…¥

1.  åˆ›å»ºå®ä½“ç±»å’Œå…¶ä»–æ³¨å…¥æ–¹å¼ç›¸åŒ
2.  é…ç½® Spring é…ç½®æ–‡ä»¶

é¦–å…ˆéœ€è¦åœ¨é…ç½®æ–‡ä»¶çš„å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ¡ä»¶ï¼š

```xml
xmlns:p="http://www.springframework.org/schema/p"
```

æ¥ç€åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å³å¯ï¼š

```xml
<bean id="user" class="com.cunyu.pojo.User" p:name="æ‘é›¨é¥" p:address="è´µå·"/>
```

3.  æµ‹è¯•æ–¹æ³•åŒå…¶ä»–æ³¨å…¥æ–¹å¼

#### 2.3.2 c å‘½åæ³¨å…¥

1.  åˆ›å»ºå®ä½“ç±»å’Œå…¶ä»–æ³¨å…¥æ–¹å¼ç›¸åŒ
2.  é…ç½® Spring é…ç½®æ–‡ä»¶

é¦–å…ˆéœ€è¦åœ¨é…ç½®æ–‡ä»¶çš„å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ¡ä»¶ï¼š

```xml
xmlns:c="http://www.springframework.org/schema/c"
```

æ¥ç€åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å³å¯ï¼š

```xml
<bean id="user" class="com.cunyu.pojo.User" c:name="æ‘é›¨é¥" c:address="è´µå·"/>
```

3.  æµ‹è¯•æ–¹æ³•åŒå…¶ä»–æ³¨å…¥æ–¹å¼